# Logbook
### Date: 10th August 2025
### Project: Fraud Detection System
### Issues Resolved: [SD-02](https://github.com/EsosaOrumwese/fraud-detection-system/issues/25) `in-progress`
### Reference commits: Check commits on this date (if any)

* 12:17am
  * Iron out salient issues in current docs for 1A
    1. Fix the seed merchants schema reference
       * Problem: The artefact for `transaction_schema_merchant_ids` points at `transaction_schema.avsc` instead of the ingress schema you authored for the processed merchant seed list. That’s inconsistent with the dictionary, which already references `schemas.ingress.layer1.yaml#/merchant_ids`.
       * Patch (artefact registry): Point the artefact at the ingress schema and keep the object as a dataset (not a raw schema file).
    2. Rename RNG event “tie_break_rank” → “residual_rank” (clearer semantics)
       * Problem: We use “tie_break_rank” for two different concepts: 
         * (a) ranking fractional remainders during integerisation and 
         * (b) the per-country site order in egress. 
       * Fix: Let’s reserve residual_rank for (a) and site_order for (b). This starts with the RNG event name + field.
    3. Disambiguate the egress site order and clean up the cache
       * Problem: Downstream (“outlet_catalogue”) uses tie_break_rank to mean the per-country site order, which is different from “residual rank”. 
       * Fix: Rename to site_order in egress, and rename the cached residual rank column to `residual_rank`.
    4. Remove the stray `parameter_hash` column from egress
       * Problem: `parameter_hash` appears as a nullable column in egress, but you’re already pinning the egress partitioning to seed and fingerprint and carrying `manifest_fingerprint` per row. 
       * Fix: Keeping `parameter_hash` in the egress table invites drift. Remove it from the egress schema. 
    5. Prune CI-time artefacts (planning phase)
       * Problem: You’re in planning/design, so CI-specific datasets and scripts should be removed to avoid implying operational guarantees. Specifically: the nightly CI metrics dataset and the post_write_validation_routine script artefact
       * Fix: Remove CI-specific datasets and scripts to avoid implying operational guarantees. Specifically: the nightly CI metrics dataset and the post_write_validation_routine script artefact
    6. Correct hurdle π dependencies and schema pointer
       * Problem: `hurdle_pi_probs` depends on `nb_dispersion_coefficients` which are unrelated to the logistic hurdle $\pi$.
       * Fix: It should depend only on the design matrix + logistic coefficients. Also, its schema pointer should align to schemas.1A.yaml#/model/hurdle_pi_probs (not an AVSC placeholder).
    7. Make the cross-country order contract explicit (no hidden behavior)
       * We didn’t add the documentation contract stating that inter-country order is not encoded in egress; consumers must read country_set.rank. No CI checks needed now—just clear, binding docs.

* 6:46pm
  * Decided to update `appendix_A_mathematics` docs to shift to a well-defined and more concrete `state-flow` which matches my updated narrative and artefacts and schema.

* 11:49pm
  * Decided NOT to update maths appendix but create new folder and file for the state flows instead
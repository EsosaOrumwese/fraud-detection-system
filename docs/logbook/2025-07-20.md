# Logbook
### Date: 20th July 2025
### Project: Fraud Detection System
### Issues Resolved: [SD-02](https://github.com/EsosaOrumwese/fraud-detection-system/issues/25) `in-progress`
### Reference commits: Check commits on this date (if any)

* 4:24am
  * Ran through assumptions and narrative for "From merchants to physical sites" subsegment (1A) and found 40 (+1 later) holes
  * Resolved holes 1–40; formalize RNG logging, schema, and provenance
  * Summary:
    - Clarified hurdle vs NB design matrices; NB mean excludes developmental bucket; dispersion includes log(GDPpc).
    - Enforced true zero-truncated Poisson for K; removed unreachable K=0 branch; added retry cap + monitoring thresholds.
    - Standardized outlet stub schema (home_country_iso, legal_country_iso, site_id fixed 6 digits, non-null types).
    - Added deterministic currency→country expansion (proportional with sparse fallback + smoothing) and artefact paths/digests.
    - Specified NB Poisson–Gamma mixture mapping (μ,φ→r,p) and universal RNG audit schema (event_type, counters, parameters).
    - Defined Gumbel-top-k selection for foreign countries (one uniform per candidate) with logged keys.
    - Locked numeric environment: IEEE-754 binary64, 8 dp residual quantization, disabled FMA for Dirichlet & rounding steps.
    - Introduced post-write validation replay (μ, φ, K, Dirichlet, allocations, ordering, site_id sequence) with abort on mismatch.
    - Added monitoring corridors: NB rejection rate (≤6%), ZTP rejection percentiles, rounding deviation stats, sparse_flag incidence.
    - Documented artefact provenance (digests for coefficient & hyperparameter YAMLs, GDP bucket map, currency splits).
    - Added statistical significance metadata for θ₁ and stationarity test digest; enumerated YAML aggregation into parameter_hash.
    - Established sequence overflow policy (abort > 999,999 per merchant+country).
    - Rewrote ambiguous narrative phrases (“geographic sprawl” now explicitly K) and removed “No other assumptions are latent” overclaim.
  * Breaking changes:
    - Schema: added columns (`home_country_iso`, `legal_country_iso`, `raw_nb_outlet_draw`, `final_country_outlet_count`, `global_seed`, `tie_break_rank`), fixed site_id to 6-char string.
    - RNG log: new event types (`hurdle_bernoulli`, `gamma_component`, `poisson_component`, `dirichlet_gamma_vector`, `gumbel_key`, `stream_jump`, `nb_final`, `ztp_retry_exhausted`, `sequence_finalize`).
    - Manifest: new digest fields (`crossborder_hyperparams_digest`, `hurdle_coefficients_digest`, `gdp_bucket_map_digest`, `settlement_shares_digest`, `currency_country_split_digest`, `stationarity_test_digest`).
  * Migration:
    - Older catalogues (pre-fingerprint X) lack new columns and expanded audit events; comparison tooling must branch on schema_version.
    - Rebuild required to produce compatible downstream artefacts.

* 4:31am
  * Added old assumptions and narrative txt files to respective `assumptions/` and `narrative/` in `docs/prompt_engr/model_spec/data-gen` for version control purposes
  * Linked my short-lived branches with my remote repo (`origin`) to prevent loss of progress should my laptop decide to have issues.


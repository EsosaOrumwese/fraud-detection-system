# Logbook
### Date: 24th January 2026
### Project: Fraud Detection System
### Reference commits: Check commits on this date (if any)

* 4:41am
  - SR: ran sanity check of ScenarioRunner submit flow with local wiring/policy. Found schema validation mismatch when validating Pydantic model_dump against JSON Schema (datetime + None fields cause failures). Logged in component_scenario_runner.impl_actual.md entry 2026-01-24 04:41:45. Proposed fix: validate model_dump(mode="json", exclude_none=True) before ingress validation.

* 4:44am
  - SR: fixed ingress schema validation to use request.model_dump(mode="json", exclude_none=True) in ScenarioRunner.submit_run. Logged in component_scenario_runner.impl_actual.md entry 2026-01-24 04:44:09.

* 4:45am
  - SR: fixed ledger schema validation to use JSON-safe dumps for RunStatus/RunPlan; re-ran local submit sanity check (passed schema validation; got lease-held response due to stale local lease). Logged in component_scenario_runner.impl_actual.md entry 2026-01-24 04:45:48.

* 4:49am
  - Read updated root AGENTS.md and noted new requirement for a living build-plan doc at docs/model_spec/platform/implementation_maps/component_{COMP}.build_plan.md before further platform implementation planning.

* 4:59am
  - Updated AGENTS.md to explicitly define "living plan" as progressive elaboration: phase list first, then phase-specific sections with definition-of-done checklists, expanding only when entering the phase.

* 5:07am
  - SR: added living build-plan doc at docs/model_spec/platform/implementation_maps/component_scenario_runner.build_plan.md with phased roadmap and Phase 2 sections + DoD checklists. Logged in component_scenario_runner.impl_actual.md entry 2026-01-24 05:07:44.

* 5:13am
  - Added proposed end-state platform repo layout to scratch_files/scratch.md for component-focused structure review.

* 5:17am
  - Updated README.md repository layout section to reflect the proposed end-state platform component layout.

* 5:23am
  - SR: drafted Phase 2 implementation plan (durable storage + idempotency) in component_scenario_runner.impl_actual.md (Entry: 2026-01-24 05:20:30).

* 5:30am
  - SR: implemented Phase 2 storage + authority store changes (ObjectStore + S3 backend, DB-backed equivalence/leases, wiring updates, psycopg dependency, tests). Logged in component_scenario_runner.impl_actual.md entry 2026-01-24 05:28:30. Ran pytest for authority store (2 passed).

* 5:35am
  - SR: recorded Phase 2 hardening gap and updated build plan with Phase 2.5 hardening DoD checklist (component_scenario_runner.build_plan.md). Logged in component_scenario_runner.impl_actual.md entry 2026-01-24 05:35:58.

* 5:42am
  - SR: locked target platform stack to AWS (S3 + RDS Postgres + ECS Fargate + Kinesis). Updated SR build plan and impl_actual; added config/platform/sr/wiring_aws.yaml.

* 5:47am
  - SR: wrote Phase 2.5 hardening plan in component_scenario_runner.impl_actual.md (Entry: 2026-01-24 05:47:18).

* 5:50am
  - SR: implemented Phase 2.5 hardening (immutability guards, S3 CAS append, lease validation/renew). Updated impl_actual (Entry: 2026-01-24 05:50:29). Ran pytest for authority store (2 passed).

* 5:58am
  - SR: added Phase 2.5 tests (Postgres smoke, concurrency, S3 CAS/unit + integration) and fixed plan_hash JSON serialization in runner. Ran pytest for new tests: 2 passed, 2 skipped (envâ€‘gated). Logged in component_scenario_runner.impl_actual.md entry 2026-01-24 05:58:14.

* 7:09am
  - Renamed platform implementation map/build plan files to drop `component_` prefix (scenario_runner.impl_actual.md and scenario_runner.build_plan.md). Updated AGENTS.md and implementation_maps README accordingly; logged in scenario_runner.impl_actual.md entry 2026-01-24 07:09:54.

* 9:58am
  - SR: clarified local dev stack guidance (MinIO + Postgres recommended; FS + SQLite allowed) in scenario_runner.build_plan.md. Logged in scenario_runner.impl_actual.md entry 2026-01-24 09:58:16.

* 9:59am
  - SR: corrected local dev guidance to state FS + SQLite are not recommended (smoke only) and Phase 2.5 hardening must run on MinIO + Postgres. Logged in scenario_runner.impl_actual.md entry 2026-01-24 09:59:41.

* 10:40am
  - SR: planned local parity profiles (MinIO + Postgres) and wiring changes; logged in scenario_runner.impl_actual.md entry 2026-01-24 10:40:41.

* 10:41am
  - SR: implemented local parity profile and S3 endpoint overrides; updated SR service README. Logged in scenario_runner.impl_actual.md entry 2026-01-24 10:41:47.

* 11:24am
  - SR: documented Phase 2.5 local-parity decision trail (MinIO/Postgres setup, docker context, image tag choice, S3 creds/bucket, Postgres port conflict) in scenario_runner.impl_actual.md entry 2026-01-24 11:24:39. Updated wiring_local_parity to port 5433 and README to reflect Postgres port.

* 11:26am
  - SR: finalized local parity stack (MinIO + Postgres) with updated compose (minio/mc latest, MC_HOST_local init, Postgres port 5433). Installed psycopg in venv. Ran S3 + Postgres integration tests with MinIO creds; all 3 tests passed. Logged in scenario_runner.impl_actual.md entry 2026-01-24 11:26:44 and marked Phase 2.5 complete in build plan.

* 11:36am
  - Added SR local parity test env vars to .env and documented how to run Phase 2.5 integration tests in services/scenario_runner/README.md.

* 11:37am
  - Corrected README test instructions to use a PowerShell-safe .env loader command.

* 11:08am
  - SR: added local parity docker compose stack (infra/local/docker-compose.sr-parity.yaml). Attempted to bring up stack; Docker engine not available (desktop-linux pipe missing; default pipe requires elevated/Docker Desktop running). Awaiting user to start Docker Desktop or provide running Docker daemon.

# Logbook
### Date: 29th January 2026
### Project: Fraud Detection System
### Reference commits: Check commits on this date (if any)

* 12:32am
  - Pruned legacy IG pull/READY Make targets per request (streaming‑only entrypoints remain).

* 12:36am
  - Normalized today’s logbook header to match the standard format used in prior days.

* 12:40am
  - Planned IG Phase 9 validation (push‑only): defined acceptance criteria, local smoke steps, and config enforcement checks in `docs/model_spec/platform/implementation_maps/ingestion_gate.impl_actual.md`.

* 12:45am
  - Ran IG Phase 9 push‑only tests: `.\\.venv\\Scripts\\python.exe -m pytest tests/services/ingestion_gate -q` → 16 passed, 1 skipped (Werkzeug deprecation warnings).

* 1:08am
  - Planned WSP READY consumer runner so SR can drive WSP automatically; documented design intent, idempotency strategy, and test plan in `docs/model_spec/platform/implementation_maps/world_streamer_producer.impl_actual.md`.

* 1:11am
  - Implemented WSP READY consumer runner (file‑bus): reads READY + run_facts_view, resolves scenario_id + engine_run_root, streams via WSP, and appends READY run records.
  - Added Make targets for READY consumer and unit tests for READY handling + duplicate skip.

* 1:12am
  - Fixed READY consumer tests (created temp object-store root before writing allowlist).
  - Re‑ran WSP tests: `.\\.venv\\Scripts\\python.exe -m pytest tests/services/world_streamer_producer/test_ready_consumer.py tests/services/world_streamer_producer/test_runner.py -q` → 6 passed.

* 1:39am
  - Diagnosed IG `SCHEMA_FAIL` quarantines during SR→WSP→IG run; found arrival_events_5B policy referenced array schema while payloads are single-row objects.
  - Updated `config/platform/ig/schema_policy_v0.yaml` to validate `#/egress/s4_arrival_events_5B/items` and documented the reasoning trail in `docs/model_spec/platform/implementation_maps/ingestion_gate.impl_actual.md`.

* 1:43am
  - Increased local WSP stream pacing (`policy.stream_speedup`) from 60 → 600 in `config/platform/profiles/local.yaml` to keep smoke runs fast while preserving ordering; documented in WSP impl_actual.

* 1:47am
  - Fixed IG schema fragment resolution: `_load_schema_ref` now grafts root `$defs`/`$id`/`$schema` onto fragment schemas so item validation can resolve `$ref` entries.

* 1:52am
  - Updated IG payload schema validation to use a registry‑backed Draft202012Validator with fragment `$ref` wrappers, so external schema refs like `schemas.layer1.yaml#/$defs/hex64` resolve correctly.

* 1:55am
  - Fixed relative schema refs by assigning `$id` to the base schema URI when missing; this gives the registry a proper base for `schemas.layer1.yaml#/$defs/…`.

* 2:00am
  - Added fallback schema resolution: if a referenced schema filename is missing under `schema_root`, search `docs/model_spec/data-engine/**/<name>` to resolve shared defs like `schemas.layer1.yaml`.

* 2:04am
  - Adjusted IG payload schema loading: refs starting with `docs/` now resolve from repo root instead of `schema_root`, matching how the schema_policy paths are written.

* 2:08am
  - Added nullable normalization for IG payload schemas: `nullable: true` now expands to `null` in JSON Schema so engine rows with nulls validate.

* 2:11am
  - Re‑ran SR→WSP (cap 20) and confirmed IG now validates + admits `arrival_events_5B` (no new schema failures).

* 2:16am
  - Added `platform-smoke` Make target to run SR→WSP→IG smoke with a generated equivalence key and capped events (requires IG service in another terminal).

* 2:23am
  - Drafted EB v0 build plan (streaming‑only) and created `docs/model_spec/platform/implementation_maps/event_bus.build_plan.md`; logged initial decision trail in `event_bus.impl_actual.md`.

* 2:28am
  - Locked EB v0 decisions (partitioning, offset shape, checkpoint store) and updated `event_bus.build_plan.md`; logged decision trail in `event_bus.impl_actual.md`.

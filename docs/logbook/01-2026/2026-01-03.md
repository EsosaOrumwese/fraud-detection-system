# Logbook
### Date: 3rd January 2026
### Project: Fraud Detection System
### Reference commits: Check commits on this date (if any)

* 12:05am
   - Reviewed scenario_runner spec folder (README, scenario_runner.md) and contracts (run_facts_view, scenario_run_request, scenario_definition, run_status_event) for alignment with rails and engine interface pack.
   - Noted potential spec issues: contracts duplicate rails ID/timestamp/digest types instead of referencing rails contracts, README references a missing contracts/README.md, and several non-ASCII characters appear in README/scenario_runner.md section headings.

* 12:07am
   - Aligned `s7_audit_report_v1` schema in `contracts/schemas/layer1/schemas.2B.yaml` with the authoritative 2B spec (checks/summary/fingerprint fields) to fix S8 validation rejecting the current S7 report shape.

* 12:45am
   - Added auto-select of the newest S5/S6 run_report (by created_utc, then mtime) when multiple run_ids exist, logging the chosen run_id instead of failing with resume ambiguity (`packages/engine/src/engine/layers/l1/seg_2B/s5_router/l2/runner.py`, `packages/engine/src/engine/layers/l1/seg_2B/s6_virtual_edge/l2/runner.py`).

* 12:07am
   - Fixed 2A S0 merchant_mcc_map sourcing to prefer date-stamped parquet snapshots (e.g., 2025-12-31) over lexicographic "v" folders/CSV, so merchant_id space aligns with 1A/1B outputs.
   - Enforced Int64/Int32 typing when materialising merchant_mcc_map to match schema and avoid string IDs that caused zero virtual arrivals in 2B S6.
* 12:12am
   - Normalized non-ASCII characters in scenario_runner README and scenario_runner.md (quotes, dashes, arrows, section references) to ASCII-safe equivalents.
   - Added missing contracts/README.md listing scenario runner contract schemas.
* 12:22am
   - Reviewed scratch.md proposed Rails-referencing diffs for Scenario Runner contracts; identified adjustments needed for $ref path resolution and remaining seed type mismatch with Rails.
* 12:27am
   - Applied scratch.md Rails-reference fixes to Scenario Runner contracts with corrected relative $ref paths, bumped contract versions to 0.1.1, and aligned engine digest objects for run facts pins.
* 12:28am
   - Normalized non-ASCII punctuation in scenario_runner contract YAMLs to ASCII (quotes, dashes, arrows).
* 12:42am
   - Added a clarification in scenario_runner.md allowing stricter lexical constraints (e.g., numeric seed) to satisfy engine interface requirements while still referencing Rails types.
* 12:44am
   - Updated Rails id_types.schema.yaml to define uint64 and bind seed to uint64 (no longer opaque string) to align with engine interface expectations.
* 12:48am
   - Updated Scenario Runner contracts to reference Rails seed type (uint64) via $ref + local uint64 in scenario_run_request and run_facts_view.
   - Adjusted Scenario Runner spec note to remove numeric-seed example now that Rails seed is uint64.

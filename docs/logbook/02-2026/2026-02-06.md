# Logbook
### Date: 6th February 2026
### Project: Fraud Detection System
### Reference commits: Check commits on this date (if any)

* 04:01AM
  - Ran 6B Phase 2 attachment + sessionisation statistical checks (approx distinct counts, arrival concentration, linkage degrees, session duration/arrival counts) for run c25a...
  - Added Phase 2 analysis to segment_6B_published_report.md with detailed explanations and realism verdict.
  
* 04:13AM
  - Extended 6B Phase 2 analysis (no report edits): joined arrival_events_5B with arrival_entities_6B and 6A/5A bases to assess channel mix, cross-border (party vs merchant country), device/account linkage diversity, merchant class mix, virtual share by class, tzid vs merchant tz match, and multi-arrival session gap structure.
* 04:22AM
  - Extended 6B Phase 2 with class-level cross-border analysis, merchant-weighted vs arrival-weighted cross-border rates (deduped merchant_dim), and session gap distributions by merchant class using multi-arrival session samples.
* 04:30AM
  - Appended extended Phase 2 analysis sections to segment_6B_published_report.md (channel mix/virtual posture, geographic cross-border + tz alignment, linkage diversity, population weighting, merchant class mix, class-level cross-border with volume effects, and class-conditioned session gaps). Reworked lists to avoid nested bullets.
* 05:02AM
  - Computed cross-border rates by merchant size deciles and top-1%/top-5% merchant buckets; quantified arrival-share and cross-border amplification for large merchants.
  - Computed full multi-arrival session gap distributions by virtual vs non-virtual and virtual session counts (324 of 76,270 multi-arrival sessions).
  - Computed cross-border rates by party segment_id (arrival-weighted) to assess segment-level bias.
* 05:12AM
  - Added 6B Phase 2 extensions to segment_6B_published_report.md: cross-border by merchant size deciles with top-1%/top-5% impact, session gap distributions by virtual vs non-virtual, and cross-border rates by party segment. Renumbered Phase 2 conclusion to 11.15.
* 05:26AM
  - Ran Phase 2 extensions: cross-border by merchant size deciles within each demand_class (sampled) with top-decile share summary; session gap distributions by virtual vs non-virtual using full multi-arrival sessions; cross-border rates by party segment_id (sampled). Prepared interpretation notes.
* 05:41AM
  - Added Phase 2 extensions to segment_6B_published_report.md: within-class merchant size deciles (volume-driven cross-border gradients), corridor matrix of merchant_countryâ†’party_country with concentration summary, and session gap distributions by local hour and timezone region. Renumbered Phase 2 conclusion to 11.18.
* 06:06AM
  - Ran Phase 3 (S2 baseline flows/events) statistical checks: amount distribution (min/max/quantiles), distinct amount count and per-amount shares, precision check, per-merchant distinct amounts, class/virtual amount profiles, and timing/amount alignment between flows, events, and arrival_events (sample-based). Drafted interpretation notes.

* 05:40AM
  - Control+Ingress parity run (200 per output): platform_run_id=platform_20260206T052035Z, scenario_run_id=f29ac2c20e2f4d505bac7ae4b1f66936, SR message_id=3bbc870df9c02f1ee8108b3f82779bf5308802814b6c13533805ba6cb88c571a.
  - WSP emitted 4x200 (traffic.fraud, arrival_events, arrival_entities, flow_anchor.fraud). Evidence: runs/fraud-platform/platform_20260206T052035Z/world_streamer_producer/world_streamer_producer.log.
  - EB counts: traffic.fraud=200, arrival_events=200, arrival_entities=200, flow_anchor.fraud=200; baseline topics=0. Audit=1.
  - IG Postgres: admissions=800, receipts=800 (decision=ADMIT). Receipt_ref run-scope mismatch persists: receipt_ref points to s3://fraud-platform/platform_20260206T042550Z/... while pins_json platform_run_id=platform_20260206T052035Z.
  - IEG projector run: processed_total=600; projection DB shows dedupe=800, apply_failures=0, graph_version=334a5fd863dcc917bd540926136a9383bf56ce6154c44f1cab3e89d0441e1cea, run_config_digest=d30b0d7f38d1eb5df612fbc019d4fb212644a53cd6b2dd2fa25f9fab8bbae47c. Evidence DB: runs/fraud-platform/platform_20260206T052035Z/identity_entity_graph/projection/identity_entity_graph.db.

* 08:26AM
  - Fixed IG receipt/quarantine path scoping to use envelope `platform_run_id` instead of service env.
  - Added receipt prefix override in ReceiptWriter and admission; added test `test_receipt_ref_scoped_to_envelope_run_id`.
  - Tests: `python -m pytest tests/services/ingestion_gate/test_admission.py -q`.
* 06:28AM
  - Added Phase 3 (S2 baseline flows/events) analysis to segment_6B_published_report.md with detailed interpretations, including policy alignment against amount_model_6B, pricing uniformity, merchant-size decile checks, geography/segment/time conditioning, and flow/event timing alignment. 
* 06:37AM
  - Added exact flow count and per-amount share table to Phase 3 amount distribution section in segment_6B_published_report.md.

* 08:47AM
  - Began Phase 4.2 IEG-only closure work: migrations, health/metrics, reconciliation, replay manifest, tests.
  - Added plan entry to identity_entity_graph.impl_actual.md.
* 06:58AM
  - Added Phase 4 (S3 fraud overlay) analysis to segment_6B_published_report.md with campaign catalogue vs observed rates, fraud_flag/campaign integrity, overlay amount uplift distribution, event-stream consistency, and class-level fraud signal assessment.

* 09:00AM
  - Implemented IEG-only Phase 4.2 closures: explicit migrations, projector health/metrics/reconciliation artifacts, backpressure logging, EB-only replay manifest writer.
  - Tests: `python -m pytest tests/services/identity_entity_graph -q`.
* 09:05AM
  - Ran Phase 4 deep-dive analyses (no report edits): fraud concentration by entity (top1/top5% shares), repeat victimization counts, fraud targeting by class/segment/geo/country (sampled), fraud temporal clustering by local hour/dow/date (sampled), inter-arrival gap distributions (sampled; sparse fraud gaps), and fraud uplift ratio vs base amount.

# Logbook
### Date: 6th February 2026
### Project: Fraud Detection System
### Reference commits: Check commits on this date (if any)

* 04:01AM
  - Ran 6B Phase 2 attachment + sessionisation statistical checks (approx distinct counts, arrival concentration, linkage degrees, session duration/arrival counts) for run c25a...
  - Added Phase 2 analysis to segment_6B_published_report.md with detailed explanations and realism verdict.

* 04:13AM
  - Extended 6B Phase 2 analysis (no report edits): joined arrival_events_5B with arrival_entities_6B and 6A/5A bases to assess channel mix, cross-border (party vs merchant country), device/account linkage diversity, merchant class mix, virtual share by class, tzid vs merchant tz match, and multi-arrival session gap structure.

* 04:22AM
  - Extended 6B Phase 2 with class-level cross-border analysis, merchant-weighted vs arrival-weighted cross-border rates (deduped merchant_dim), and session gap distributions by merchant class using multi-arrival session samples.

* 04:30AM
  - Appended extended Phase 2 analysis sections to segment_6B_published_report.md (channel mix/virtual posture, geographic cross-border + tz alignment, linkage diversity, population weighting, merchant class mix, class-level cross-border with volume effects, and class-conditioned session gaps). Reworked lists to avoid nested bullets.

* 05:02AM
  - Computed cross-border rates by merchant size deciles and top-1%/top-5% merchant buckets; quantified arrival-share and cross-border amplification for large merchants.
  - Computed full multi-arrival session gap distributions by virtual vs non-virtual and virtual session counts (324 of 76,270 multi-arrival sessions).
  - Computed cross-border rates by party segment_id (arrival-weighted) to assess segment-level bias.

* 05:12AM
  - Added 6B Phase 2 extensions to segment_6B_published_report.md: cross-border by merchant size deciles with top-1%/top-5% impact, session gap distributions by virtual vs non-virtual, and cross-border rates by party segment. Renumbered Phase 2 conclusion to 11.15.

* 05:26AM
  - Ran Phase 2 extensions: cross-border by merchant size deciles within each demand_class (sampled) with top-decile share summary; session gap distributions by virtual vs non-virtual using full multi-arrival sessions; cross-border rates by party segment_id (sampled). Prepared interpretation notes.

* 05:40AM
  - Control+Ingress parity run (200 per output): platform_run_id=platform_20260206T052035Z, scenario_run_id=f29ac2c20e2f4d505bac7ae4b1f66936, SR message_id=3bbc870df9c02f1ee8108b3f82779bf5308802814b6c13533805ba6cb88c571a.
  - WSP emitted 4x200 (traffic.fraud, arrival_events, arrival_entities, flow_anchor.fraud). Evidence: runs/fraud-platform/platform_20260206T052035Z/world_streamer_producer/world_streamer_producer.log.
  - EB counts: traffic.fraud=200, arrival_events=200, arrival_entities=200, flow_anchor.fraud=200; baseline topics=0. Audit=1.
  - IG Postgres: admissions=800, receipts=800 (decision=ADMIT). Receipt_ref run-scope mismatch persists: receipt_ref points to s3://fraud-platform/platform_20260206T042550Z/... while pins_json platform_run_id=platform_20260206T052035Z.
  - IEG projector run: processed_total=600; projection DB shows dedupe=800, apply_failures=0, graph_version=334a5fd863dcc917bd540926136a9383bf56ce6154c44f1cab3e89d0441e1cea, run_config_digest=d30b0d7f38d1eb5df612fbc019d4fb212644a53cd6b2dd2fa25f9fab8bbae47c. Evidence DB: runs/fraud-platform/platform_20260206T052035Z/identity_entity_graph/projection/identity_entity_graph.db.

* 05:41AM
  - Added Phase 2 extensions to segment_6B_published_report.md: within-class merchant size deciles (volume-driven cross-border gradients), corridor matrix of merchant_country→party_country with concentration summary, and session gap distributions by local hour and timezone region. Renumbered Phase 2 conclusion to 11.18.

* 06:06AM
  - Ran Phase 3 (S2 baseline flows/events) statistical checks: amount distribution (min/max/quantiles), distinct amount count and per-amount shares, precision check, per-merchant distinct amounts, class/virtual amount profiles, and timing/amount alignment between flows, events, and arrival_events (sample-based). Drafted interpretation notes.

* 06:28AM
  - Added Phase 3 (S2 baseline flows/events) analysis to segment_6B_published_report.md with detailed interpretations, including policy alignment against amount_model_6B, pricing uniformity, merchant-size decile checks, geography/segment/time conditioning, and flow/event timing alignment.

* 06:37AM
  - Added exact flow count and per-amount share table to Phase 3 amount distribution section in segment_6B_published_report.md.

* 06:58AM
  - Added Phase 4 (S3 fraud overlay) analysis to segment_6B_published_report.md with campaign catalogue vs observed rates, fraud_flag/campaign integrity, overlay amount uplift distribution, event-stream consistency, and class-level fraud signal assessment.

* 08:26AM
  - Fixed IG receipt/quarantine path scoping to use envelope `platform_run_id` instead of service env.
  - Added receipt prefix override in ReceiptWriter and admission; added test `test_receipt_ref_scoped_to_envelope_run_id`.
  - Tests: `python -m pytest tests/services/ingestion_gate/test_admission.py -q`.

* 08:47AM
  - Began Phase 4.2 IEG-only closure work: migrations, health/metrics, reconciliation, replay manifest, tests.
  - Added plan entry to identity_entity_graph.impl_actual.md.

* 09:00AM
  - Implemented IEG-only Phase 4.2 closures: explicit migrations, projector health/metrics/reconciliation artifacts, backpressure logging, EB-only replay manifest writer.
  - Tests: `python -m pytest tests/services/identity_entity_graph -q`.

* 09:05AM
  - Ran Phase 4 deep-dive analyses (no report edits): fraud concentration by entity (top1/top5% shares), repeat victimization counts, fraud targeting by class/segment/geo/country (sampled), fraud temporal clustering by local hour/dow/date (sampled), inter-arrival gap distributions (sampled; sparse fraud gaps), and fraud uplift ratio vs base amount.

* 09:07AM
  - Attempted fresh 200-event parity run; LocalStack/MinIO endpoints unreachable.
  - `make platform-parity-stack-up` failed: Docker Desktop engine not available.
  - Parity run deferred until Docker services are running.

* 09:16AM
  - Expanded report section 13.8–13.12 in segment 6B with additional interpretation detail. Computed Phase‑4 extension metrics: fraud concentration by merchant size deciles, per‑campaign class and cross‑border targeting (using merchant_class_profile + deduped merchant_zone_profile + party_base_6A), and inter‑arrival gaps within campaign; verified no repeat fraud per campaign+merchant+party.

* 09:20AM
  - Added segment 6B report sections 13.13–13.15 (merchant size decile fraud concentration, per‑campaign class/geo targeting, and per‑campaign inter‑arrival gaps) with detailed interpretation.

* 10:13AM
  - Updated local parity runbook to include explicit IEG projector + query service steps and run-scoped artifact checks.

* 11:04AM
  - Phase‑5 extension computations (no report edits): case seq monotonicity and schema completeness on 10‑file sample; bank fraud rate by amount bins and merchant size deciles; bank fraud rate by cross‑border and top corridors on 5M sample; verified campaign↔truth label mapping across all fraud flows.

* 11:06AM
  - Added Phase 5 extensions (14.13–14.17) to segment 6B report: case monotonicity and schema completeness (sample), bank‑view vs amount/size/geo, and truth↔campaign enforcement with detailed interpretation.

* 11:09AM
  - Phase‑6 statistical analysis runs (no report edits): end‑to‑end counts/ratios, event/case coverage, bank‑view stratification by class/geo/amount/size (samples), truth min/max, and sample truth vs bank confusion.

* 12:03PM
  - Added Phase 6 end‑to‑end statistical synthesis to segment 6B report (chain consistency, signal preservation, bank‑view stratification, truth calibration limits, case integrity).

* 12:06PM
  - Phase 7 analysis (no report edits): computed Gini for sessions/flows/fraud concentration, class imbalance for truth/bank/campaigns, and stratified bank‑view rates by region/country/class on 5M sample.

* 12:11PM
  - Added Phase 7 distributional diagnostics to segment 6B report with detailed interpretation (Gini concentration, class imbalance, stratified bank‑view flatness).

* 12:13PM
  - Phase 8 statistical tests (no report edits): chi‑square/Cramer's V for bank_fraud vs class/cross_border/fraud_flag and fraud_flag vs class/segment; effect sizes for amount vs bank_fraud and amount vs fraud_flag on 5M sample.

* 12:16PM
  - Added Phase 8 statistical tests to segment 6B report with detailed interpretation (chi‑square/Cramer's V, effect sizes, correlations).

* 12:23PM
  - Phase 7/8 optional refinements (no report edits): computed HHI and top‑k shares for sessions/flows/fraud; computed Gini fraud per merchant by region.

* 01:13PM
  - Added optional Phase 7/8 refinements to report (HHI, top‑k share curves, regional Gini).

* 01:30PM
  - Expanded report explanations across phases 1–8 (added additional interpretation paragraphs to geographic, pricing, fraud overlay, labeling, synthesis, distributional diagnostics, and statistical tests).

* 01:34PM
  - Added final realism grade section (18) to segment 6B report with detailed justification and B/A+ remediation roadmap.

* 02:04PM
  - Generated Segment 6B statistical plots (01–10) in docs/reports/reports/eda/segment_6B/plots covering truth saturation, bank-view flatness, confusion matrix, case gaps/durations, fraud concentration, top-k shares, amount distribution, uplift, and cross-border rates.

* 02:38PM
  - Refreshed 6B presentation plots (02,04,05,08) via docs/reports/reports/eda/segment_6B/plot_segment_6B_refresh.py: corrected amount-bin ordering, masked low-support heatmap cells, changed case gap/duration charts to exact-value bars, and rebuilt amount distribution as discrete price-point bars with readable labels.

* 02:45PM
  - Standardized Segment 6B plot deck style end-to-end using docs/reports/reports/eda/segment_6B/plot_segment_6B_uniform_all.py (uniform typography, title styling, axis labeling, annotation formatting, and figure sizing) and fixed final QA defects (confusion-matrix annotation contrast + Lorenz title clipping).

* 02:48PM
  - Appended Section 19 (Visual Diagnostics) to docs/reports/reports/eda/segment_6B/segment_6B_published_report.md with all 10 standardized plot embeds and detailed interpretations tied to prior phase findings (truth saturation, bank-view flatness, confusion, case timing defects, concentration, amount discreteness, uplift, and cross-border posture).

* 02:49PM
  - Added local-parity runbook note describing optional IEG live mode (run_forever) with run-scope locks for dev/prod-like behavior.

* 02:53PM
  - Logbook format decision: new entries will use the short `* HH:MMAM/PM` style.

* 02:54PM
  - Reordered Segment 6B report so final grade remains the last section: moved former Section 19 visual diagnostics above final grade and renamed it to 'Appendix A' with subheads A.1-A.10; Section 18 now closes the document.

* 03:00PM
  - Normalized this day logbook to match house style: unified timestamp format (* HH:MMAM/PM), inserted blank line separation between entries, and cleaned mixed timestamp syntax into one readable layout.

* 03:10PM
  - Added IEG flow narrative + operating posture (not auto-started, default `--once`, optional run_forever) to `docs/model_spec/platform/implementation_maps/identity_entity_graph.impl_actual.md`.

* 03:20PM
  - Updated Phase 4.2 in `docs/model_spec/platform/implementation_maps/platform.build_plan.md` to reflect current IEG behavior (run-scope gating, dedupe key, payload_hash scope, watermark note, parity ops).

* 03:28PM
  - Marked Phase 4.2 status as **IEG-complete, integration-pending** in `docs/model_spec/platform/implementation_maps/platform.build_plan.md`.

* 03:32PM
  - Expanded Phase 4.3 (OFP) in `docs/model_spec/platform/implementation_maps/platform.build_plan.md` with detailed v0 DoD subsections aligned to RTDL pre-design decisions.

* 04:08PM
  - Expanded `docs/model_spec/platform/implementation_maps/online_feature_plane.build_plan.md` into a detailed Phase 4.3 closure plan (A-H mapped phases, explicit DoDs, validation gates, and narrative joins `EB -> OFP`, optional `IEG -> OFP`, `DF -> OFP`).
  - Added OFP planning rationale entry to `docs/model_spec/platform/implementation_maps/online_feature_plane.impl_actual.md` before edits.
  - Corrected Phase 4.3.A wording drift in `docs/model_spec/platform/implementation_maps/platform.build_plan.md` to reflect OFP intake from admitted EB traffic with optional IEG consultation.


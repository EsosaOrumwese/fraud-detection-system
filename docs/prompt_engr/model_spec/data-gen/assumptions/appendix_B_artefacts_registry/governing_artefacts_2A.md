## Subsegment 2A: Deriving the civil time zone (Integrated Registry)

| ID / Key                    | Path Pattern                                                             | Role                                                                                 | Semver Field                 | Digest Field                                                                                                                                          |
|-----------------------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------------------|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| **tz_world_polygons_2025a** | `artefacts/priors/tz_world/2025a/tz_world_2025a.*`                       | IANA time‑zone polygon shapefile and companion files                                 | `semver` (in sidecar)        | `tz_world_shp_digest`, `tz_world_shx_digest`, `tz_world_dbf_digest`, `tz_world_prj_digest`, `tz_world_cpg_digest` aggregated into `tz_polygon_digest` |
| **tz_index_digest**         | `artefacts/priors/tz_world/2025a/tz_index_digest.txt`                    | STR-tree index digest (deterministic build, pickle protocol 5)                       | Manifest semver              | `tz_index_digest`                                                                                                                                     |
| **tz_nudge**                | `config/timezone/tz_nudge.yml`                                           | Deterministic nudge distance ε                                                       | `semver`                     | `tz_nudge_digest`                                                                                                                                     |
| **tz_overrides**            | `config/timezone/tz_overrides.yaml`                                      | Manual mapping overrides for exceptional zones                                       | `semver`                     | `tz_overrides_digest`                                                                                                                                 |
| **zoneinfo_version**        | `zoneinfo_version.yml`                                                   | IANA tzdata version descriptor                                                       | `semver` (`tzdata_version`)  | `tz_horizon_digest` (see horizon below)                                                                                                               |
| **tzdata_archive**          | `artefacts/priors/tzdata/tzdata2025a.tar.gz`                             | Official IANA tzdata release archive                                                 | (in `zoneinfo_version.yml`)  | `tzdata_archive_digest`                                                                                                                               |
| **simulation_horizon**      | `config/timezone/simulation_horizon.yml`                                 | Simulation start/end bounds for timeline extraction                                  | `semver`                     | `tz_horizon_digest`                                                                                                                                   |
| **rng_proof**               | `docs/rng_proof.md`                                                      | Formal proof of RNG‑stream isolation                                                 | Git commit (ref in manifest) | `rng_proof_digest`                                                                                                                                    |
| **output_catalogue**        | `output/site_catalogue/partition_date=*/merchant_id=*/site_id=*.parquet` | Output catalogue: must include `nudge_lat`, `nudge_lon`, `TZID`, fold, offsets, etc. | Manifest semver, schema      | `tz_polygon_digest` (must match input artefact lineage)                                                                                               |
| **output_catalogue_schema** | `output/site_catalogue_schema.json`                                      | Parquet schema descriptor for site catalogue output                                  | schema_version               | `sha256_digest`                                                                                                                                       |
| **audit_log**               | `logs/tz_assignment_audit.log`                                           | Structured audit/event log for all assignment, nudge, override, error, and rollback  | Manifest semver              | (run-specific; include unique event enforcement)                                                                                                      |
| **ci_validation_log**       | `logs/ci_override_validation.log`                                        | Nightly validation output: override drift checks, manifest consistency, event replay | Manifest semver              | (run-specific)                                                                                                                                        |
| **tz_cache_bytes_record**   | `output/tz_cache_bytes.txt`                                              | Exact byte size of in-memory zone cache for build/CI threshold                       | Manifest semver              | (run-specific; must match manifest field)                                                                                                             |
| **licence_files**           | `LICENSES/`                                                              | All licences (CC BY 4.0 for tz_world, Public Domain for tzdata)                      | Manifest semver              | SHA-256 for each licence, referenced in manifest                                                                                                      |


**Process/Contract Enforcement (add after table):**

* **STR-tree index, nudge artefact, and all overrides are mandatory and governed.**
* **All output catalogue files must include per-row nudge and provenance fields** as mandated in the output schema.
* **Any missing audit event, catalogue column, or artefact triggers a manifest drift and hard abort in downstream pipeline.**
* **CI validation and audit logs are tracked for every build; nightly validation must include override drift and manifest checks.**
* **Every artefact listed has an explicit versioning and digesting contract.**
* **All relevant licences are tracked and must be referenced for every governed artefact.**


**Notes:**

* The `tz_world_polygons_2025a.*` pattern covers `.shp`, `.shx`, `.dbf`, `.prj` and `.cpg`; each must declare `semver` and `sha256_digest` in its sidecar or manifest entry.
* The `zoneinfo_version.yml` file holds both the tzdata version string and governs horizon defaults; its `tz_horizon_digest` covers both the tzdata version and the simulation bounds.
* Any addition, removal, or version bump of these artefacts must follow semver rules and will automatically refresh the overall manifest digest via CI.
* Pattern matching is case‑sensitive; path separators use Unix‑style forward slashes.
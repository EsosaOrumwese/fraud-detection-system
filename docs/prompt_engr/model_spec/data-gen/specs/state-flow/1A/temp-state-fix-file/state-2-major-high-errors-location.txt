Here’s the **exhaustive map** of where the two **Major/High** issues show up in S2 (by **commission/omission**), with the binding background anchors from S0/S1. No fixes yet—just where to patch later.

# Major/High #1 — Attempt pairing is ambiguous (time/file-order vs counter)

**All affected spots (commission):**

* **S2.6 — Validator contract (Replay proof, step 2):** *“Interleave by **time/counter** to reconstruct attempt pairs (Gamma→Poisson).”*&#x20;
* **S2.6 — Determinism & ordering (MUST):** *“Attempts are indexed by loop counter (**not stored**); **ordering is by file order + envelope counters**.”*&#x20;
* **S2.7 — Validator reference algorithm:** uses `pairwise_by_time_or_counter(...)`.
* **S2.9 — Conformance tests (KAT #3):** *“Rebuild attempts by interleaving component events …”* (again allows time/order).&#x20;
* **S2.4 — Notes under reference pseudocode:** *“**Attempt indices are implicit** (reconstructed by alternating Gamma/Poisson events per merchant).”* (explicitly says **no stored attempt id**; relies on alternation/order).&#x20;

**Omission (what’s missing but required):**

* No single authoritative rule is pinned (e.g., **pair by non-overlapping counter intervals** within each substream, or persist `nb_attempt`). The ambiguity appears across **S2.4, S2.6, S2.7, S2.9** (all the bullets above).

**Binding background (why this is Major):**

* S0/S1 validators are **order-invariant**; file/emit order and wall-time are non-authoritative under concurrency—pairing must be by counter intervals (or an explicit attempt id).&#x20;

---

# Major/High #2 — Component stream metadata under-specified

**What must be pinned (two parts):**

1. the exact **`module`** registry literal for `gamma_component` and `poisson_component` (not `1A.nb_*` placeholders), and
2. the **semantics of `index=0`** for NB Gamma (Gamma is **scalar**; `index` is a fixed placeholder `0`, not a component selector).

**All affected spots (commission):**

* **S2.5 — Envelope & retention text:** requires `module` in the envelope and phrases producers as “`1A.nb_*` modules” (placeholder, not the registry literal).&#x20;
* **S2.9 — Outputs (state boundary):** repeats the envelope (including `module`) for the three streams but still **doesn’t pin** concrete `module` strings for the component producers.&#x20;
* **S2.3 — Pseudocode emission of Gamma:** emits `gamma_component(..., context="nb", **index=0**, …)` without defining what `index` means in NB (scalar).&#x20;
* **S2.5 — Payload (must):** requires `gamma_component` carry `context="nb", **index=0**` but gives no scalar/placeholder semantics.&#x20;

**Omission (what’s missing but required):**

* A single statement (once) that **NB Gamma is scalar** and `index` is **always 0** as a placeholder (not a component index).
* A registry-closed **`module` literal** for each component stream, pinned in **S2.5** (envelope spec) and echoed in **S2.9** (Outputs).

**Binding background:**

* S1/schema discipline treats `module`/`substream_label` as **registry-closed literals**; validators depend on exact strings, not placeholders.&#x20;

---

These augmentations incorporate the reviewer’s two pointers:

* we’ve now **explicitly tagged** the “attempts are implicit via alternation” line under S2.4; and
* we’ve **explicitly tagged S2.9 Outputs** for the `module` literal omission.

This map is now closed over **all** occurrences (commission + omission) for both Major/High issues.

<<<PP‑FIX id=1>>
Name: Spatial prior blend coefficients
Symbol: αₖ
Scope: merchant_location
---------------------------------

PRIOR:
type: Convex combination
hyperparameters:
  coefficients_file: config/spatial_blend.yaml
units: dimensionless
default_policy: abort on missing file
justification: Specifies weight vector for blending raster and vector spatial priors.

CALIBRATION_RECIPE:
input_path: s3://data/spatial_blend/reference_distributions.csv
objective: KL divergence minimization
algorithm: L-BFGS
random_seed: 42
convergence_tol: 1e-6
script_digest: sha256:<to-be-populated>  # build/scripts/calibrate_spatial_blend.py

INTERFACE_CONSUMER:
artefact_name: config/spatial_blend.yaml
function: load_spatial_blend_weights
description: Loads blend coefficients for spatial prior sampler.

POSTERIOR_VALIDATION:
metric: KS distance between sampled vs reference distributions
acceptance_range: [0.0, 0.05]
sample_size: 10000

PROVENANCE_TAG:
artefact_name: config/spatial_blend.yaml
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Weight vector for convex blend of spatial priors.

TEST_PATHWAY:
test: CI spatial blend validation
input: spatial_blend_stats.log
assert: KS distance < 0.05

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=2>>
Name: Fenwick tree integer scaling factor
Symbol: S
Scope: merchant_location
---------------------------------

PRIOR:
type: Deterministic function
hyperparameters:
  formula: S = (2^64 - 1 - n) / W_f
units: dimensionless
default_policy: abort on overflow
justification: Scales float raster weights to uint64 for Fenwick sampling.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: spatial_sampler.py
function: build_fenwick_tree
description: Uses S to scale weights and construct Fenwick tree.

POSTERIOR_VALIDATION:
metric: max overflow event count
acceptance_range: [0, 0]
sample_size: 10000

PROVENANCE_TAG:
artefact_name: spatial_sampler.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Integer scaling factor for Fenwick tree sampling.

TEST_PATHWAY:
test: CI fenwick scaling test
input: fenwick_scale_stats.log
assert: no overflow events

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=3>>
Name: Global raster grid resolution
Symbol: Δλ, Δφ
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed constant
hyperparameters:
  resolution: 1/1200°
units: degrees
default_policy: abort on mismatch
justification: Defines angular spacing of the global raster grid.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: raster_resampler.py
function: sample_raster_grid
description: Samples latitude/longitude indices using fixed grid resolution.

POSTERIOR_VALIDATION:
metric: max deviation from expected grid cell size
acceptance_range: [0.0, 1e-6]
sample_size: 10000

PROVENANCE_TAG:
artefact_name: config/raster_config.yaml
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Angular grid spacing for raster sampling.

TEST_PATHWAY:
test: CI grid resolution test
input: grid_config.log
assert: resolution constant at 1/1200°

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=4>>
Name: Intra-pixel jitter flag
Symbol: jitter_enabled
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed boolean
hyperparameters:
  default_value: false
units: boolean
default_policy: use prior
justification: Toggles uniform jitter on pixel-center sampling.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: pixel_center_sampler.py
function: apply_intra_pixel_jitter
description: Adds ±½ Δ random offsets when enabled.

POSTERIOR_VALIDATION:
metric: uniformity of jitter distribution
acceptance_range: [0.0, 0.05]
sample_size: 10000

PROVENANCE_TAG:
artefact_name: config/placement_config.yaml
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Flag to enable or disable intra-pixel uniform jitter.

TEST_PATHWAY:
test: CI jitter flag test
input: jitter_stats.log
assert: no jitter when disabled

Confidence=MEDIUM
<<<END PP‑FIX>>>

<<<PP‑FIX id=5>>
Name: Road-proximity rejection threshold
Symbol: d_road_max
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed constant
hyperparameters:
  threshold_m: 50
units: metres
default_policy: abort on breach
justification: Maximum distance from primary roads for road-based priors.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: road_filter.py
function: filter_by_road_distance
description: Rejects samples farther than threshold from road network.

POSTERIOR_VALIDATION:
metric: KS distance of distance distribution
acceptance_range: [0.0, 0.05]
sample_size: 10000

PROVENANCE_TAG:
artefact_name: road_filter.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Maximum allowed distance from road for placement.

TEST_PATHWAY:
test: CI road proximity test
input: road_distance_stats.log
assert: all distances ≤ 50 m

Confidence=MEDIUM
<<<END PP‑FIX>>>

<<<PP‑FIX id=6>>
Name: Wilson 95% lower-bound
Symbol: L
Scope: validation
---------------------------------

PRIOR:
type: Fixed threshold
hyperparameters:
  confidence_level: 0.95
units: proportion
default_policy: abort on drop
justification: Ensures acceptance probability lower confidence bound.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: acceptance_monitor.py
function: compute_wilson_lower
description: Calculates lower bound L on acceptance proportion.

POSTERIOR_VALIDATION:
metric: L (Wilson lower bound)
acceptance_range: [0.90, 1.0]
sample_size: 10000

PROVENANCE_TAG:
artefact_name: acceptance_monitor.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Lower 95% confidence bound on placement acceptance rate.

TEST_PATHWAY:
test: CI acceptance bound test
input: acceptance_stats.log
assert: L ≥ 0.90

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=7>>
Name: Trend-alert drop threshold
Symbol: Δp_max
Scope: validation
---------------------------------

PRIOR:
type: Fixed threshold
hyperparameters:
  threshold_pp: 5
units: percentage points
default_policy: alert only
justification: Threshold for week-over-week acceptance drop alerts.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: acceptance_monitor.py
function: monitor_trend_drop
description: Detects week-over-week drops in acceptance rate.

POSTERIOR_VALIDATION:
metric: max drop in p̂
acceptance_range: [0, 5]
sample_size: weekly build

PROVENANCE_TAG:
artefact_name: acceptance_monitor.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Alert threshold for significant acceptance drop.

TEST_PATHWAY:
test: CI trend alert test
input: trend_stats.log
assert: no drop > 5 ppt without alert

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=8>>
Name: Termination-cap formula constants
Symbol: r_min, A_max
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed formula
hyperparameters:
  r_min: 0.10
  A_max_formula: min(500, 10/max(0.10, a_L))
units: count
default_policy: abort on exceed
justification: Caps sampling attempts based on minimum success rate.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: placement_attempt_manager.py
function: compute_max_attempts
description: Computes A_max based on observed success rate.

POSTERIOR_VALIDATION:
metric: mismatch in computed A_max
acceptance_range: [0, 0]
sample_size: all runs

PROVENANCE_TAG:
artefact_name: placement_attempt_manager.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Maximum allowed placement attempts per location.

TEST_PATHWAY:
test: CI termination cap test
input: attempt_stats.log
assert: A_max matches formula

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=9>>
Name: Philox sub-stream keys & strides
Symbol: keys, stride
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed assignment
hyperparameters:
  keys: ["site_sampling","polygon_interior","footfall_lognormal","fenwick_tie_break","tz_resample"]
  stride_formula: low64(SHA256(key))
units: dimensionless
default_policy: abort on duplicate
justification: Defines RNG sub-stream stride per key.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: philox_rng_manager.py
function: derive_substream_stride
description: Computes and assigns strides for RNG sub-streams.

POSTERIOR_VALIDATION:
metric: uniqueness of strides
acceptance_range: [5, 5]
sample_size: 1

PROVENANCE_TAG:
artefact_name: philox_rng_manager.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Philox RNG sub-stream key definitions.

TEST_PATHWAY:
test: CI philox substream test
input: stride_stats.log
assert: all strides distinct

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=10>>
Name: Earth radius for Haversine
Symbol: R
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed constant
hyperparameters:
  radius_km: 6371.0088
units: kilometres
default_policy: abort on change
justification: Radius value for spherical distance calculations.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: distance_calculator.py
function: haversine_distance
description: Calculates great-circle distances using R.

POSTERIOR_VALIDATION:
metric: distance calculation error
acceptance_range: [0.0, 1e-6]
sample_size: 1000

PROVENANCE_TAG:
artefact_name: distance_calculator.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Value of Earth radius for distance formula.

TEST_PATHWAY:
test: CI haversine test
input: distance_stats.log
assert: distances stable within tolerance

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=11>>
Name: Contraction-hierarchies graph path & version
Symbol: graph_file
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed artefact reference
hyperparameters:
  pattern: osm_ch_graph_{snapshot}.bin
units: N/A
default_policy: abort if missing
justification: Specifies CH graph file for road distances.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: osm_ch_graph_{snapshot}.bin
function: load_contraction_hierarchy
description: Loads road network graph for distance calculations.

POSTERIOR_VALIDATION:
metric: graph load success rate
acceptance_range: [1.0, 1.0]
sample_size: random nodes

PROVENANCE_TAG:
artefact_name: osm_ch_graph_{snapshot}.bin
sha256: <to-be-populated>

SHORT_DESCRIPTION:
File pattern and version for CH graph.

TEST_PATHWAY:
test: CI CH graph load test
input: graph_load_stats.log
assert: successful loads for all tests

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=12>>
Name: Crash-tolerant write protocol
Symbol: write_protocol
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed policy
hyperparameters:
  temp_suffix: .tmp
  atomic_steps: [fsync, atomic_rename]
units: N/A
default_policy: abort on protocol violation
justification: Ensures atomic, crash-safe writes of Parquet outputs.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: file_writer.py
function: write_atomic
description: Implements crash-tolerant file write sequence.

POSTERIOR_VALIDATION:
metric: recovery success rate
acceptance_range: [1.0, 1.0]
sample_size: simulated failures

PROVENANCE_TAG:
artefact_name: file_writer.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Protocol for atomic, crash-safe writes.

TEST_PATHWAY:
test: CI write protocol test
input: write_test.log
assert: atomic writes complete successfully

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=13>>
Name: Audit-event schema fields
Symbol: audit_schema
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed schema reference
hyperparameters:
  schema_file: config/audit_schema.yaml
units: N/A
default_policy: abort on schema mismatch
justification: Defines fields for placement and failure event logs.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: config/audit_schema.yaml
function: validate_and_write_audit_event
description: Ensures events match schema before logging.

POSTERIOR_VALIDATION:
metric: schema compliance failure rate
acceptance_range: [0, 0]
sample_size: all events

PROVENANCE_TAG:
artefact_name: config/audit_schema.yaml
sha256: <to-be-populated>

SHORT_DESCRIPTION:
JSON schema for placement audit events.

TEST_PATHWAY:
test: CI audit schema test
input: audit_schema.log
assert: no schema violations

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=14>>
Name: Capital-fallback selection logic
Symbol: capital_selector
Scope: merchant_location
---------------------------------

PRIOR:
type: Fixed policy
hyperparameters:
  criteria: [role_type='administrative', primary_flag=true]
units: N/A
default_policy: abort on none
justification: Determines fallback capital when multiple flags present.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: remoteness_module.py
function: select_capital
description: Applies hierarchical rules to choose administrative capital.

POSTERIOR_VALIDATION:
metric: selection success rate
acceptance_range: [1.0, 1.0]
sample_size: all countries

PROVENANCE_TAG:
artefact_name: capitals_dataset_2024.parquet
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Logic for selecting fallback capital based on roles.

TEST_PATHWAY:
test: CI capital fallback test
input: capital_selection_stats.log
assert: no aborts due to missing capital

Confidence=HIGH
<<<END PP‑FIX>>>

<<<PP‑FIX id=15>>
Name: Fenwick-alias uniform deviate
Symbol: cdf_threshold_u
Scope: merchant_location
---------------------------------

PRIOR:
type: Uniform
hyperparameters:
  min: 0
  max: 1
units: dimensionless
default_policy: abort on RNG error
justification: Provides uniform deviate for alias/Fenwick sampling.

CALIBRATION_RECIPE:
input_path: N/A
objective: Not applicable
algorithm: Not applicable
random_seed: N/A
convergence_tol: N/A
script_digest: N/A

INTERFACE_CONSUMER:
artefact_name: alias_sampler.py
function: sample_uniform_cdf_threshold
description: Draws uniform deviate for sampling algorithm.

POSTERIOR_VALIDATION:
metric: Kolmogorov–Smirnov statistic
acceptance_range: [0.0, 0.05]
sample_size: 10000

PROVENANCE_TAG:
artefact_name: philox_rng_manager.py
sha256: <to-be-populated>

SHORT_DESCRIPTION:
Uniform random threshold for alias/Fenwick sampler.

TEST_PATHWAY:
test: CI alias uniform test
input: alias_uniform_stats.log
assert: KS statistic < 0.05

Confidence=MEDIUM
<<<END PP‑FIX>>>

##### END PARAMETER_SPEC #####

id=1  | gaps_closed=calibration|posterior|provenance       | notes=Added calibration, validation, and provenance  
id=2  | gaps_closed=calibration|posterior|provenance       | notes=Filled scaling recipe, validation, and provenance  
id=3  | gaps_closed=calibration|posterior|provenance|interface | notes=Specified grid tests and consumer  
id=4  | gaps_closed=calibration|posterior|provenance|interface | notes=Completed jitter flag tests and consumer  
id=5  | gaps_closed=calibration|posterior|provenance|interface | notes=Added road filter validation and interface  
id=6  | gaps_closed=calibration|posterior|provenance|interface | notes=Defined Wilson bound tests and provenance  
id=7  | gaps_closed=calibration|posterior|provenance|interface | notes=Specified trend-alert tests and consumer  
id=8  | gaps_closed=calibration|posterior|provenance|interface | notes=Completed termination-cap formula spec and tests  
id=9  | gaps_closed=calibration|posterior|provenance|interface | notes=Added Philox key tests and consumer  
id=10 | gaps_closed=calibration|posterior|provenance|interface | notes=Specified Earth radius validation and consumer  
id=11 | gaps_closed=calibration|posterior|provenance|interface | notes=Added CH graph load tests and provenance  
id=12 | gaps_closed=calibration|posterior|provenance|interface | notes=Completed write protocol spec and tests  
id=13 | gaps_closed=calibration|posterior|provenance|interface | notes=Defined audit schema tests and provenance  
id=14 | gaps_closed=calibration|posterior|provenance|interface | notes=Populated capital fallback spec and tests  
id=15 | gaps_closed=calibration|posterior|provenance|interface | notes=Filled alias deviate spec and validation  

<<PS‑END>>
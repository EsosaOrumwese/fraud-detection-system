--- PP 1 ---
Name: Routing site weight normalization (probabilities per outlet)
Symbol: $p_i = F_i / \sum_j F_j$
Scope: merchant_location
Prior_type: Deterministic function (of persisted foot‑traffic scalars)
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: Yes
Provenance_tag: Yes
Units: dimensionless (probabilities)
Default_policy: abort (if $\sum_j F_j = 0$)
Interface_consumer: Router normalization step in `router/engine.py`
Description: Normalises raw foot‑traffic scalars $F_i$ into a probability distribution $p_i$.
Anchor: “then normalises to obtain $p_i = F_i / \sum_{j=1}^{N_m} F_j$.” 
Context: “The routing engine’s first responsibility is to compute the raw share $w_i = F_i$ for all $i$, then normalises to obtain $p_i = F_i / \sum_j F_j$.” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 1 ---

--- PP 2 ---
Name: Alias table O(1) sampling arrays
Symbol: `prob`, `alias`
Scope: merchant_location
Prior_type: Deterministic function (Vose alias algorithm)
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: Yes
Provenance_tag: Yes
Units: dimensionless (uint32 indices, float64 probabilities)
Default_policy: abort (if reconstruction/hash mismatch)
Interface_consumer: Alias sampler in `router/alias.py`
Description: Builds `prob` and `alias` arrays for constant‑time outlet sampling.
Anchor: “the alias package builds `prob` and `alias`, and its digest is recorded as `alias_digest`.” 
Context: “Because naïve multinomial sampling in O(N) time would be too slow … alias package builds `prob` and `alias`.” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 2 ---

--- PP 3 ---
Name: Corporate‑day random effect variance
Symbol: $\sigma_\gamma^2$
Scope: merchant_location
Prior_type: Loaded constant (MLE fit)
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: Yes
Provenance_tag: Yes
Units: variance (dimensionless)
Default_policy: abort (if missing file)
Interface_consumer: `router/day_effect.py`
Description: Variance for the corporate‑day log‑normal random effect $\gamma_d$.
Anchor: “$\gamma_d\sim\mathrm{LogNormal}(\mu_\gamma,\sigma_\gamma^2)$ … $\sigma_\gamma^2$ is loaded from `routing_day_effect.yml`.” 
Context: “Long‑run shares, however, are not enough; real data requires a corporate‑day random effect γ_d∼LogNormal(μ_γ,σ_γ²).” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 3 ---

--- PP 4 ---
Name: Virtual merchant CDN edge country weights
Symbol: $Q=[q_1,\dots,q_K]$
Scope: merchant_location
Prior_type: Loaded constant (empirical distribution)
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: Yes
Provenance_tag: Yes
Units: dimensionless (probabilities)
Default_policy: use prior (equal weights fallback)
Interface_consumer: CDN alias sampler in `router/cdn.py`
Description: Country‑level probabilities for purely virtual merchants’ edge‑node assignment.
Anchor: “merchants flagged `is_virtual=1` receive a shadow list of edge‑node probabilities $q_c$, using the same alias‑table logic.” 
Context: “Certain merchants flagged `is_virtual=1` receive a shadow list of edge‑node probabilities (q_c), using the same alias‑table logic to select `ip_country`.” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 4 ---

--- PP 5 ---
Name: Routing validation thresholds
Symbol: $\epsilon_p$, $\epsilon_\rho$
Scope: merchant_location
Prior_type: Loaded constants
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: Yes
Provenance_tag: Yes
Units: dimensionless (probability diff, correlation)
Default_policy: abort (if breached)
Interface_consumer: Validation in `router/validate.py`
Description: Tolerances for per‑site share deviation and empirical correlation.
Anchor: “asserts $|\hat p_i - p_i| < \epsilon_p$ … and $|\rho_{\mathrm{emp}} - \rho^*| < \epsilon_\rho$.” 
Context: “Once the full synthetic day is produced … CI computes share and correlation metrics and asserts both tolerances.” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 5 ---

--- PP 6 ---
Name: Audit batch size and checksum
Symbol: $B=10^6$, checksum = SHA256(…)
Scope: merchant_location
Prior_type: Fixed constants
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: Yes
Provenance_tag: Yes
Units: $B$: count; checksum: hex string
Default_policy: abort (if drift)
Interface_consumer: Audit logger in `router/audit.py`
Description: Number of events per audit batch and reproducibility checksum.
Anchor: “After routing every 1 000 000 events … computes checksum = SHA256(merchant_id || batch_index || cumulative_counts_vector).” 
Context: “Finally, once per million routed events, the engine computes checksum … and appends it to logs.” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 6 ---

--- PP 7 ---
Name: Routing RNG policy (seed derivation)
Symbol: SHA1(global_seed ∥ "router" ∥ merchant_id)
Scope: merchant_location
Prior_type: Deterministic hash policy
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: Yes
Provenance_tag: Yes
Units: hex (160‑bit)
Default_policy: abort (on mismatch)
Interface_consumer: `router/prng.py`
Description: Derives Philox key for merchant‑specific PRNG stream.
Anchor: “Seed derivation uses `hashlib.sha1()` on (global_seed, "router", merchant_id), governed by `rng_policy.yml`.” 
Context: “To derive the Philox key, the router computes a SHA‑1 hash … with policy enforced by `rng_policy.yml`.” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 7 ---

--- PP 8 ---
Name: Routing performance thresholds (throughput, memory)
Symbol: TP ≥200 MB/s, Mem ≤2 GB
Scope: merchant_location
Prior_type: Loaded constants
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: Yes
Provenance_tag: Yes
Units: MB/s, GB
Default_policy: abort (if SLA breached)
Interface_consumer: CI performance monitor in `router/perf.py`
Description: Throughput and memory SLA thresholds for routing jobs.
Anchor: “Thresholds (TP ≥200, Mem ≤2) are loaded from `config/routing/performance.yml`.” 
Context: “Thresholds … are loaded from `config/routing/performance.yml`.” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 8 ---

--- PP 9 ---
Name: Corporate‑day random effect log‑normal mean
Symbol: μ_γ
Scope: merchant_location
Prior_type: Deterministic derived constant
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: No
Provenance_tag: Yes
Units: dimensionless
Default_policy: use prior
Interface_consumer: `router/day_effect.py`
Description: Mean of log‑normal for γ_d, set to −½σ_γ² to enforce E[γ_d]=1.
Anchor: “γ_d ∼ LogNormal(μ_γ,σ_γ²) with μ_γ = −½σ_γ².” 
Context: “real data requires a corporate‑day random effect γ_d∼LogNormal(μ_γ,σ_γ²) with μ_γ = −½σ_γ², inducing realistic synchrony.” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=N
  posterior_missing=N
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 9 ---

--- PP 10 ---
Name: Uniform deviate for alias and day‑effect sampling
Symbol: u ∼ U(0,1)
Scope: merchant_location
Prior_type: Uniform
Prior_specified: Yes
Calibration_recipe: No
Posterior_validation: No
Provenance_tag: Yes
Units: dimensionless
Default_policy: abort on RNG error
Interface_consumer: `router/prng.py` uniform_sampler
Description: Uniform(0,1) draw used in O(1) alias lookup and γ_d sampling.
Anchor: “k = floor(u * N_m)” 
Context: “requiring only a scaled threshold in the O(1) alias lookup: k = floor(u * N_m) …” 
Gap_flags:
  prior_missing=N
  hyperparams_missing=N
  calibration_missing=Y
  posterior_missing=Y
  provenance_missing=N
  units_missing=N
  default_policy_missing=N
  interface_consumer_missing=N
  description_missing=N
Confidence=HIGH
--- END PP 10 ---

<<PP‑END>>
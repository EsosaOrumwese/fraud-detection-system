subsegments:
  - id: "2A"
    name: "Deriving the Civil Time‑Zone"
    artifacts:
 
      # 1 CROSS‑LAYER INPUT
      
      - name: site_catalogue
        path: data/outputs/1B/site_catalogue/seed={seed}/fingerprint={manifest_fingerprint}/
        type: dataset
        category: input
        semver: "{semver}"
        version: "{manifest_fingerprint}"
        digest: "{sha256}"
        manifest_key: mlr.1B.output.site_catalogue
        license: "{spdx_or_internal}"
        role: Site-catalogue rows from 1B (lat/lon, tzid, foot-traffic fields, provenance).
        dependencies: [ site_catalogue_schema ]
        source: internal
        owner: { owner_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: site_catalogue_schema
        cross_layer: true
        notes: null
  
      # 2 TZ‑WORLD SHAPEFILE BUNDLE
      
      - name: tz_world_shapefile_2025_shp
        path: artefacts/priors/tz_world/2025a/tz_world_2025a.shp
        type: reference
        category: spatial
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.spatial.tz_world_2025a.shp
        license: ODbL-1.0
        role: Main polygon geometry for IANA TZ boundaries.
        dependencies: [ ]
        source: external
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tz_world_shapefile_2025_shx
        path: artefacts/priors/tz_world/2025a/tz_world_2025a.shx
        type: reference
        category: spatial
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.spatial.tz_world_2025a.shx
        license: ODbL-1.0
        role: Spatial‑index companion for tz_world.shp.
        dependencies: [ tz_world_shapefile_2025_shp ]
        source: external
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tz_world_shapefile_2025_dbf
        path: artefacts/priors/tz_world/2025a/tz_world_2025a.dbf
        type: reference
        category: spatial
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.spatial.tz_world_2025a.dbf
        license: ODbL-1.0
        role: Attribute table for tz_world polygons.
        dependencies: [ tz_world_shapefile_2025_shp ]
        source: external
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tz_world_shapefile_2025_prj
        path: artefacts/priors/tz_world/2025a/tz_world_2025a.prj
        type: reference
        category: spatial
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.spatial.tz_world_2025a.prj
        license: ODbL-1.0
        role: Projection (EPSG:4326) file.
        dependencies: [ tz_world_shapefile_2025_shp ]
        source: external
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tz_world_shapefile_2025_cpg
        path: artefacts/priors/tz_world/2025a/tz_world_2025a.cpg
        type: reference
        category: spatial
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.spatial.tz_world_2025a.cpg
        license: ODbL-1.0
        role: Code‑page definition for tz_world attributes.
        dependencies: [ tz_world_shapefile_2025_shp ]
        source: external
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tz_world_metadata
        path: artefacts/priors/tz_world/2025a/tz_world_metadata.json
        type: mapping
        category: spatial
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.spatial.tz_world_2025a.meta
        license: ODbL-1.0
        role: Per‑zone country‑set mapping for sanity checks.
        dependencies: [ tz_world_shapefile_2025_shp ]
        source: external
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null
   
      # 3 IANA TZ DATA RELEASE
      
      - name: tzdata_archive_2025a
        path: artefacts/priors/tzdata/tzdata2025a.tar.gz
        type: reference
        category: timezone
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.tzdata.2025a
        license: PublicDomain
        role: Official IANA tzdata archive.
        dependencies: [ ]
        source: external
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: iana_links_snapshot
        path: artefacts/priors/tzdata/iana_links_snapshot.parquet
        type: reference
        category: timezone
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.tzdata.iana_links
        license: PublicDomain
        role: Snapshot of Link → Zone equivalence used for diagnostics.
        dependencies: [ tzdata_archive_2025a ]
        source: internal
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null
  
      # 4 GOVERNING CONFIG BLOBS
      
      - name: tz_nudge_policy
        path: config/timezone/tz_nudge.yml
        type: config
        category: timezone
        semver: "{semver}"
        version: "{config_version}"
        digest: "{sha256}"
        manifest_key: mlr.2A.config.tz_nudge
        license: "{spdx_or_internal}"
        role: ε‑nudge magnitude & algorithm for deterministic tie‑breaks.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tz_overrides
        path: config/timezone/tz_overrides.yaml
        type: config
        category: timezone
        semver: "{semver}"
        version: "{config_version}"
        digest: "{sha256}"
        manifest_key: mlr.2A.config.tz_overrides
        license: "{spdx_or_internal}"
        role: Manual override table with evidence URLs & expiry dates.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: tz_overrides_schema
        cross_layer: true
        notes: null

      - name: tz_overrides_schema
        path: schema/tz_overrides.avsc
        type: schema
        category: timezone
        semver: "{semver}"
        version: "{schema_version}"
        digest: "{sha256}"
        manifest_key: mlr.2A.schema.tz_overrides
        license: "{spdx_or_internal}"
        role: "Schema for tz_overrides rows."
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ dev, staging, prod ]
        schema: null
        cross_layer: true
        notes: null

      - name: simulation_horizon
        path: config/simulation_horizon.yml
        type: config
        category: simulation
        semver: "{semver}"
        version: "{config_version}"
        digest: "{sha256}"
        manifest_key: mlr.2A.config.simulation_horizon
        license: "{spdx_or_internal}"
        role: Start & end date for timeline cache extraction.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: zoneinfo_version
        path: config/zoneinfo_version.yml
        type: config
        category: timezone
        semver: "{semver}"
        version: "{config_version}"
        digest: "{sha256}"
        manifest_key: mlr.2A.config.zoneinfo_version
        license: "{spdx_or_internal}"
        role: Declares expected zoneinfo library build.
        dependencies: [ tzdata_archive_2025a ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: zoneinfo_digest
        path: artefacts/manifests/zoneinfo_digest.txt
        type: manifest
        category: runtime_environment
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.manifest.zoneinfo_digest
        license: "{spdx_or_internal}"
        role: Digest of the zoneinfo build/version used by ZoneInfo for DST checks.
        dependencies: [ zoneinfo_version ]   # already present in 2A
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: "Referenced by 4B structural/DST legality checks."

      - name: geometry_tolerance_policy
        path: config/numeric/geometry_tolerance_policy.yaml
        type: config
        category: numeric_environment
        semver: "{semver}"
        version: "{config_version}"
        digest: "{sha256}"
        manifest_key: mlr.numeric.geometry_tolerance
        license: "{spdx_or_internal}"
        role: Allowed floating‑point tolerance for geometry ops.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: timestamp_precision_policy
        path: config/numeric/timestamp_precision_policy.yaml
        type: config
        category: numeric_environment
        semver: "{semver}"
        version: "{config_version}"
        digest: "{sha256}"
        manifest_key: mlr.numeric.timestamp_precision
        license: "{spdx_or_internal}"
        role: Millisecond truncation & rounding rules.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: locale_policy
        path: config/locale_policy.yaml
        type: config
        category: localisation
        semver: "{semver}"
        version: "{config_version}"
        digest: "{sha256}"
        manifest_key: mlr.locale.policy
        license: "{spdx_or_internal}"
        role: Locale rules (ISO, CLDR) relevant to time‑zone overrides.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      
      # 5 INDEX / CACHE
      
      - name: tz_index_pickle
        path: artefacts/cache/tz_world/2025a/{sha256}/tz_index.pkl
        type: cache
        category: spatial_index
        semver: "{semver}"
        version: "{sha256}"
        digest: "{sha256}"
        manifest_key: mlr.2A.cache.tz_index
        license: "{spdx_or_internal}"
        role: STR‑tree pickle for point‑in‑polygon lookup.
        dependencies: [ tz_world_shapefile_2025_shp, tzid_insertion_order, geometry_tolerance_policy, locale_policy ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: timetable_cache
        path: artefacts/cache/timetable/{sha256}/timetable_cache.parquet
        type: cache
        category: timezone
        semver: "{semver}"
        version: "{sha256}"
        digest: "{sha256}"
        manifest_key: mlr.2A.cache.timetable
        license: "{spdx_or_internal}"
        role: Run‑length‑encoded zone transitions (≤ 8 MiB).
        dependencies: [ tzdata_archive_2025a, simulation_horizon ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tz_cache_metrics
        path: artefacts/metrics/tz_cache_metrics.parquet
        type: dataset
        category: metrics
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.metrics.tz_cache
        license: "{spdx_or_internal}"
        role: Size & hit‑rate metrics for timetable cache.
        dependencies: [ timetable_cache, zoneinfo_version ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ ci ]
        schema: null
        cross_layer: false
        notes: null

      # 6 MANIFESTS & DIGESTS
      
      - name: spatial_manifest
        path: artefacts/manifests/spatial_manifest.json
        type: manifest
        category: provenance
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.manifest.spatial
        license: "{spdx_or_internal}"
        role: Aggregated digests of all spatial artefacts.
        dependencies: [ tz_world_shapefile_2025_shp, tzdata_archive_2025a ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: tz_polygon_digest
        path: artefacts/manifests/tz_polygon_digest.txt
        type: manifest
        category: provenance
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.manifest.tz_polygon_digest
        license: "{spdx_or_internal}"
        role: SHA‑256 of concatenated polygon bytes (ordered by TZID).
        dependencies: [ tz_world_shapefile_2025_shp ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tz_index_digest
        path: artefacts/manifests/tz_index_digest.txt
        type: manifest
        category: provenance
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.manifest.tz_index_digest
        license: "{spdx_or_internal}"
        role: SHA‑256 of STR‑tree pickle bytes.
        dependencies: [ tz_index_pickle ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: tzid_insertion_order
        path: artefacts/priors/tz_world/2025a/tzid_insertion_order.txt
        type: mapping
        category: spatial
        semver: "2025a.0.0"
        version: "2025a"
        digest: "{sha256}"
        manifest_key: mlr.ref.spatial.tzid_insertion_order_2025a
        license: ODbL-1.0
        role: Canonical lexicographic TZID list used when building STR‑tree.
        dependencies: [ tz_world_shapefile_2025_shp ]
        source: internal
        owner: { data_governance_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: civil_time_manifest
        path: artefacts/manifests/civil_time_manifest.json
        type: manifest
        category: provenance
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.manifest.civil_time
        license: "{spdx_or_internal}"
        role: Captures seed, tz_polygon & tz_index digests, tz_nudge digest, tzdata archive & horizon digests, and tz_cache_bytes.
        dependencies: [ spatial_manifest, tz_polygon_digest, tz_index_digest, tz_nudge_policy, tzdata_archive_2025a, simulation_horizon, timetable_cache, zoneinfo_version, zoneinfo_digest ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      - name: build_fingerprint_2A
        path: artefacts/manifests/build_fingerprint_2A.txt
        type: manifest
        category: provenance
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.manifest.build_fingerprint
        license: "{spdx_or_internal}"
        role: Composite SHA‑256 tying 2A to all governed artefacts.
        dependencies:
          - spatial_manifest
          - tz_polygon_digest
          - tz_index_digest
          - tz_nudge_policy
          - tz_overrides
          - tzdata_archive_2025a
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      # 7 EVENT SCHEMA & LOG STREAMS
      
      - name: timezone_event_schema
        path: schema/timezone_event_schema.json
        type: schema
        category: timezone_event
        semver: "{semver}"
        version: "{schema_version}"
        digest: "{sha256}"
        manifest_key: mlr.2A.schema.timezone_events
        license: "{spdx_or_internal}"
        role: JSON schema validating all timezone event streams.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: true
        notes: null

      # The following block pattern repeats for each JSONL stream
      - name: tz_lookup_error_log
        path: logs/timezone/{run_id}/tz_lookup_error.jsonl
        type: log
        category: timezone_event
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.tz_lookup_error
        license: "{spdx_or_internal}"
        role: Event where no polygon matches a site coordinate.
        dependencies: [ timezone_event_schema ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null
      
      # Add alongside tz_lookup_error_log

      - name: tz_lookup_events
        path: logs/timezone/{run_id}/tz_lookup_events.jsonl
        type: log
        category: timezone_event
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.tz_lookup_events
        license: "{spdx_or_internal}"
        role: Per‑site audit of (lat, lon, tzids_hit_list, nudge_vector, final_tzid, override_applied?).
        dependencies: [ timezone_event_schema, tz_nudge_policy, tz_overrides ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: tz_nudge_applied_log
        path: logs/timezone/{run_id}/tz_nudge_applied.jsonl
        type: log
        category: timezone_event
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.tz_nudge_applied
        license: "{spdx_or_internal}"
        role: Records ε‑nudge vector and pre/post hit sets.
        dependencies: [ timezone_event_schema, tz_nudge_policy ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: tz_override_applied_log
        path: logs/timezone/{run_id}/tz_override_applied.jsonl
        type: log
        category: timezone_event
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.tz_override_applied
        license: "{spdx_or_internal}"
        role: When an override supersedes polygon TZID (prior_tzid, scope, final_tzid).
        dependencies: [ timezone_event_schema, tz_overrides ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: time_gap_shift_log
        path: logs/timezone/{run_id}/time_gap_shift.jsonl
        type: log
        category: timezone_event
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.time_gap_shift
        license: "{spdx_or_internal}"
        role: Shifts applied to land forward‑gap legality fixes (gap_seconds, adjusted_local_time).
        dependencies: [ timezone_event_schema, simulation_horizon ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: fold_choice_log
        path: logs/timezone/{run_id}/fold_choice.jsonl
        type: log
        category: timezone_event
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.fold_choice
        license: "{spdx_or_internal}"
        role: Parity choice for backward fold (hash inputs and chosen fold).
        dependencies: [ timezone_event_schema, timestamp_precision_policy ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: utc_conversion_log
        path: logs/timezone/{run_id}/utc_conversion.jsonl
        type: log
        category: timezone_event
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.utc_conversion
        license: "{spdx_or_internal}"
        role: (t_local, offset_minutes) → event_time_utc, with precision policy applied.
        dependencies: [ timezone_event_schema, timestamp_precision_policy, zoneinfo_version ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null
      
      # 8 METRICS & CI OUTPUTS
      - name: override_metrics
        path: artefacts/metrics/override_metrics.parquet
        type: dataset
        category: metrics
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.metrics.overrides
        license: "{spdx_or_internal}"
        role: Hit‑rate & expiry‑coverage metrics for tz_overrides.
        dependencies: [ tz_overrides, site_catalogue ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ ci ]
        schema: null
        cross_layer: false
        notes: null
      
      # 9 RNG AUDIT & TRACE
      
      - name: rng_audit_2A
        path: logs/timezone/{run_id}/rng_audit_2A.log
        type: log
        category: rng_audit
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.rng_audit
        license: "{spdx_or_internal}"
        role: Structured audit of Philox counter positions.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: rng_trace_2A
        path: logs/timezone/{run_id}/rng_trace_2A.log
        type: log
        category: rng_audit
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.log.rng_trace
        license: "{spdx_or_internal}"
        role: Full trace of every RNG draw in 2A.
        dependencies: [ rng_audit_2A ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      # 10 CI SCRIPTS & TESTS
      
      - name: override_logic_ci_check
        path: ci/tests/timezone_override_validation.sh
        type: ci_test
        category: timezone_override
        semver: "{semver}"
        version: "{script_version}"
        digest: "{sha256}"
        manifest_key: mlr.2A.ci.override_validation
        license: "{spdx_or_internal}"
        role: Nightly assertion that at least one override changes lookup result.
        dependencies: [ tz_overrides, override_metrics ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ ci ]
        schema: null
        cross_layer: false
        notes: null
      
      # 11 VERSION PIN / ENVIRONMENT
      
      - name: python_lib_versions
        path: artefacts/manifests/python_lib_versions.txt
        type: manifest
        category: runtime_environment
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256}"
        manifest_key: mlr.2A.manifest.python_lib_versions
        license: "{spdx_or_internal}"
        role: Frozen pip freeze used for deterministic builds.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null
      
      # 12 ERROR / EXCEPTION CONTRACT
      
      - name: DSTLookupTieError
        path: null
        type: exception
        category: exception_contract
        semver: null
        version: null
        digest: null
        manifest_key: mlr.2A.exception.dst_lookup_tie
        license: null
        role: Raised when two polygons persist after ε‑nudge.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: TimeZoneLookupError
        path: null
        type: exception
        category: exception_contract
        semver: null
        version: null
        digest: null
        manifest_key: mlr.2A.exception.timezone_lookup
        license: null
        role: Raised when no TZ polygon matches a point.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null

      - name: TimeTableCoverageError
        path: null
        type: exception
        category: exception_contract
        semver: null
        version: null
        digest: null
        manifest_key: mlr.2A.exception.timetable_coverage
        license: null
        role: Raised when zone rules do not cover simulation horizon.
        dependencies: [ ]
        source: internal
        owner: { platform_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ runtime ]
        schema: null
        cross_layer: false
        notes: null
      
      # 13 DOCUMENTATION / PROOF
      
      - name: rng_independence_proof
        path: docs/rng_proof.md
        type: documentation
        category: proof
        semver: "{semver}"
        version: "{doc_version}"
        digest: "{sha256}"
        manifest_key: mlr.2A.docs.rng_independence
        license: "{spdx_or_internal}"
        role: Proof that fold‑parity hash is independent of Philox streams.
        dependencies: [ ]
        source: internal
        owner: { qa_team }
        last_updated: "{iso8601_timestamp}"
        environment: [ dev, ci, runtime ]
        schema: null
        cross_layer: false
        notes: null

      # 14 LICENSING (governed)
      - name: licence_files
        path: LICENSES/
        type: directory
        category: licensing
        semver: "{semver}"
        version: "{run_id}"
        digest: "{sha256_tree}"
        manifest_key: mlr.2A.licenses
        license: CC-BY-4.0-and-PublicDomain
        role: SPDX texts for tz_world  tzdata; referenced by civil_time_manifest.
        dependencies: [ ]
        source: internal
        owner: { legal_team }
        environment: [ ci, runtime ]
        schema: null
        cross_layer: true
        notes: null
$schema: "https://json-schema.org/draft/2020-12/schema"
title: DatasetManifest v0
type: object
additionalProperties: false
required:
  - schema_version
  - dataset_manifest_id
  - dataset_fingerprint
  - platform_run_id
  - replay_basis
  - label_basis
  - feature_definition_set
  - provenance
properties:
  schema_version:
    type: string
    const: "learning.dataset_manifest.v0"
  dataset_manifest_id:
    type: string
    minLength: 1
  dataset_fingerprint:
    type: string
    minLength: 8
  platform_run_id:
    type: string
    minLength: 1
  scenario_run_ids:
    type: array
    items:
      type: string
      minLength: 1
  replay_basis:
    type: array
    minItems: 1
    items:
      type: object
      additionalProperties: false
      required:
        - topic
        - partition
        - offset_kind
        - start_offset
        - end_offset
      properties:
        topic:
          type: string
          minLength: 1
        partition:
          type: integer
          minimum: 0
        offset_kind:
          type: string
          minLength: 1
        start_offset:
          type: string
          minLength: 1
        end_offset:
          type: string
          minLength: 1
  label_basis:
    type: object
    additionalProperties: false
    required:
      - label_asof_utc
      - resolution_rule
    properties:
      label_asof_utc:
        type: string
        minLength: 1
      resolution_rule:
        type: string
        minLength: 1
      maturity_days:
        type: integer
        minimum: 0
  feature_definition_set:
    type: object
    additionalProperties: false
    required:
      - feature_set_id
      - feature_set_version
    properties:
      feature_set_id:
        type: string
        minLength: 1
      feature_set_version:
        type: string
        minLength: 1
  provenance:
    type: object
    additionalProperties: false
    required:
      - ofs_code_release_id
      - config_revision
    properties:
      ofs_code_release_id:
        type: string
        minLength: 1
      config_revision:
        type: string
        minLength: 1
      run_config_digest:
        type: string

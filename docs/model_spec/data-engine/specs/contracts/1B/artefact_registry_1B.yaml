subsegments:
- id: 1B
  name: Site Geolocation
  artifacts:

  - name: s0_gate_receipt_1B
    path: data/layer1/1B/s0_gate_receipt/fingerprint={manifest_fingerprint}/s0_gate_receipt.json
    type: dataset
    category: validation
    semver: '{semver}'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.1B.validation.s0_gate_receipt
    license: Proprietary-Internal
    role: Receipt proving 1A PASS for fingerprint; enumerates sealed inputs authorised for 1B.
    dependencies: [validation_bundle_1A, validation_passed_flag]
    source: internal
    owner: {owner_team: null}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.1B.yaml#/validation/s0_gate_receipt
    cross_layer: false
    notes: 'Partition: fingerprint={manifest_fingerprint}; pathâ†”embed equality enforced.'

  # Cross-layer inputs explicitly referenced by 1B.S0 (gating semantics live in 1A bundle/flag)
  - name: validation_bundle_1A
    path: data/layer1/1A/validation/fingerprint={manifest_fingerprint}/
    type: dataset
    category: validation
    semver: '{semver}'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.1A.validation.bundle
    license: Proprietary-Internal
    role: Validator outputs for 1A (basis of consumer gate for outlet_catalogue).
    dependencies: [outlet_catalogue]
    source: internal
    owner: {qa_team: null}
    last_updated: '{iso8601_timestamp}'
    environment: [ci, runtime]
    schema:
    cross_layer: true
    notes: 'S0 computes SHA256 over ASCII-lex index to verify _passed.flag.'

  - name: validation_passed_flag
    path: data/layer1/1A/validation/fingerprint={manifest_fingerprint}/_passed.flag
    type: manifest
    category: validation
    semver: '{semver}'
    version: '{manifest_fingerprint}'
    digest: '{sha256_of_bundle}'
    manifest_key: mlr.1A.validation.passed
    license: Proprietary-Internal
    role: Boolean hash gate for 1A bundle; S0 must verify before any read of outlet_catalogue.
    dependencies: [validation_bundle_1A]
    source: internal
    owner: {qa_team: null}
    last_updated: '{iso8601_timestamp}'
    environment: [ci, runtime]
    schema:
    cross_layer: true
    notes:

  - name: outlet_catalogue
    path: data/layer1/1A/outlet_catalogue/seed={seed}/fingerprint={manifest_fingerprint}/
    type: dataset
    category: output
    semver: '{semver}'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.1A.output.outlet_catalogue
    license: Proprietary-Internal
    role: Immutable outlet stubs; order-free (join S3 for inter-country order). Read only after verifying _passed.flag.
    dependencies: [s3_candidate_set]
    source: internal
    owner: {owner_team: null}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.1A.yaml#/egress/outlet_catalogue
    cross_layer: true
    notes:

  - name: s3_candidate_set
    path: data/layer1/1A/s3_candidate_set/parameter_hash={parameter_hash}/
    type: dataset
    category: allocation
    semver: '{semver}'
    version: '{parameter_hash}'
    digest: '{sha256}'
    manifest_key: mlr.1A.s3.candidate_set
    license: '{spdx_or_internal}'
    role: Deterministic ordered candidate set; sole inter-country order authority used by 1B consumers via join.
    dependencies: []
    source: internal
    owner: {owner_team: null}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.1A.yaml#/s3/candidate_set
    cross_layer: true
    notes:

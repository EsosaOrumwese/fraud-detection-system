subsegments:
- id: 1B
  name: Site Geolocation
  artifacts:

  - name: s0_gate_receipt_1B
    path: data/layer1/1B/s0_gate_receipt/fingerprint={manifest_fingerprint}/s0_gate_receipt.json
    type: dataset
    category: validation
    semver: '{semver}'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.1B.validation.s0_gate_receipt
    license: Proprietary-Internal
    role: Receipt proving 1A PASS for fingerprint; enumerates sealed inputs authorised for 1B.
    dependencies: [validation_bundle_1A, validation_passed_flag]
    source: internal
    owner: {owner_team: "mlr-1b-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.1B.yaml#/validation/s0_gate_receipt
    cross_layer: false
    notes: 'Partition: fingerprint={manifest_fingerprint}; pathâ†”embed equality enforced.'

  # Cross-layer inputs explicitly referenced by 1B.S0 (gating semantics live in 1A bundle/flag)
  - name: validation_bundle_1A
    path: data/layer1/1A/validation/fingerprint={manifest_fingerprint}/
    type: dataset
    category: validation
    semver: '{semver}'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.1A.validation.bundle
    license: Proprietary-Internal
    role: Validator outputs for 1A (basis of consumer gate for outlet_catalogue).
    dependencies: [outlet_catalogue]
    source: internal
    owner: {owner_team: "mlr-1a-validation"}
    last_updated: '{iso8601_timestamp}'
    environment: [ci, runtime]
    schema: schemas.1A.yaml#/validation/validation_bundle
    cross_layer: true
    notes: 'S0 computes SHA-256 over ASCII-lex index (bundle index) to verify _passed.flag. Retention per Dictionary.'

  - name: validation_passed_flag
    path: data/layer1/1A/validation/fingerprint={manifest_fingerprint}/_passed.flag
    type: manifest
    category: validation
    semver: '{semver}'
    version: '{manifest_fingerprint}'
    digest: '{sha256_of_bundle}'
    manifest_key: mlr.1A.validation.passed
    license: Proprietary-Internal
    role: Boolean hash gate for 1A bundle; S0 must verify before any read of outlet_catalogue.
    dependencies: [validation_bundle_1A]
    source: internal
    owner: {owner_team: "mlr-1a-validation"}
    last_updated: '{iso8601_timestamp}'
    environment: [ci, runtime]
    schema:
    cross_layer: true
    notes: 'Content is a single line: "sha256_hex = <hex64>". Digest equals SHA-256 of the bundle = concat(raw bytes of all files listed in index.json in ASCII-lex path order), excluding the flag itself.'

  - name: outlet_catalogue
    path: data/layer1/1A/outlet_catalogue/seed={seed}/fingerprint={manifest_fingerprint}/
    type: dataset
    category: output
    semver: '{semver}'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.1A.output.outlet_catalogue
    license: Proprietary-Internal
    role: Immutable outlet stubs; order-free (join S3 for inter-country order). Read only after verifying _passed.flag.
    dependencies: [s3_candidate_set]
    source: internal
    owner: {owner_team: "mlr-1a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.1A.yaml#/egress/outlet_catalogue
    cross_layer: true
    notes:

  - name: s3_candidate_set
    path: data/layer1/1A/s3_candidate_set/parameter_hash={parameter_hash}/
    type: dataset
    category: allocation
    semver: '{semver}'
    version: '{parameter_hash}'
    digest: '{sha256}'
    manifest_key: mlr.1A.s3.candidate_set
    license: 'Proprietary-Internal'
    role: Deterministic ordered candidate set; sole inter-country order authority used by 1B consumers via join.
    dependencies: []
    source: internal
    owner: {owner_team: "mlr-1a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.1A.yaml#/s3/candidate_set
    cross_layer: true
    notes:


  # External reference inputs mirrored for licence/provenance and single-pane visibility
  - name: iso3166_canonical_2024
    path: reference/iso/iso3166_canonical/2024-12-31/iso3166.parquet
    type: dataset
    category: reference
    semver: '{semver}'
    version: '2024-12-31'
    digest: '{sha256}'
    manifest_key: mlr.ingress.iso3166_canonical_2024
    license: CC-BY-4.0
    role: Canonical ISO-3166-1 alpha-2 list; FK target for country_iso.
    dependencies: []
    source: external
    owner: {owner_team: "mlr-ingress"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.ingress.layer1.yaml#/iso3166_canonical_2024
    cross_layer: true
    notes:

  - name: world_countries
    path: reference/spatial/world_countries/2024/world_countries.parquet
    type: dataset
    category: reference
    semver: '{semver}'
    version: '2024'
    digest: '{sha256}'
    manifest_key: mlr.ingress.world_countries
    license: ODbL-1.0
    role: Country boundary polygons used for geo conformance checks.
    dependencies: [iso3166_canonical_2024]
    source: external
    owner: {owner_team: "mlr-ingress"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.ingress.layer1.yaml#/world_countries
    cross_layer: true
    notes:

  - name: population_raster_2025
    path: reference/spatial/population/2025/population.tif
    type: dataset
    category: reference
    semver: '{semver}'
    version: '2025'
    digest: '{sha256}'
    manifest_key: mlr.ingress.population_raster_2025
    license: ODbL-1.0
    role: Population raster used as spatial prior in 1B.
    dependencies: []
    source: external
    owner: {owner_team: "mlr-ingress"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.ingress.layer1.yaml#/population_raster_2025
    cross_layer: true
    notes:

  - name: tz_world_2025a
    path: reference/spatial/tz_world/2025a/tz_world.parquet
    type: dataset
    category: reference
    semver: '{semver}'
    version: '2025a'
    digest: '{sha256}'
    manifest_key: mlr.ingress.tz_world_2025a
    license: ODbL-1.0
    role: Time-zone polygons used for civil-time legality checks.
    dependencies: [world_countries]
    source: external
    owner: {owner_team: "mlr-ingress"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.ingress.layer1.yaml#/tz_world_2025a
    cross_layer: true
    notes:

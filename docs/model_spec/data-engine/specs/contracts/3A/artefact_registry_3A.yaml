subsegments:
- id: 3A
  name: Cross-Zone Merchants
  artifacts:

      # ---------------------------
      # GOVERNED POLICIES & PRIORS
      # ---------------------------
  - name: zone_mixture_policy
    path: config/policy/3A/zone_mixture_policy.yaml
    type: policy
    category: escalation
    semver: '1.0.0'
    version: '{policy_version}'
    digest: '{sha256}'
    manifest_key: mlr.3A.zone_mixture_policy
    license: Proprietary-Internal
    role: Theta thresholds and decision buckets for S1 escalation.
    dependencies: []
    source: internal
    owner: {owner_team: "mlr-3a-governance"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/policy/zone_mixture_policy_v1
    cross_layer: false
    notes:

  - name: country_zone_alphas
    path: config/allocation/country_zone_alphas.yaml
    type: policy
    category: priors
    semver: '1.0.0'
    version: '{prior_pack_version}'
    digest: '{sha256}'
    manifest_key: mlr.3A.country_zone_alphas
    license: Proprietary-Internal
    role: Dirichlet α-vector ledger per country×tzid.
    dependencies: []
    source: internal
    owner: {owner_team: "mlr-3a-governance"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/policy/country_zone_alphas_v1
    cross_layer: false
    notes:

  - name: zone_floor_policy
    path: config/allocation/zone_floor_policy.yaml
    type: policy
    category: priors
    semver: '1.0.0'
    version: '{policy_version}'
    digest: '{sha256}'
    manifest_key: mlr.3A.zone_floor_policy
    license: Proprietary-Internal
    role: Floor and bump rules applied during integerisation.
    dependencies: []
    source: internal
    owner: {owner_team: "mlr-3a-governance"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/policy/zone_floor_policy_v1
    cross_layer: false
    notes:

      # ---------------------------
      # S0 GATE SURFACES
      # ---------------------------
  - name: s0_gate_receipt_3A
    path: data/layer1/3A/s0_gate_receipt/fingerprint={manifest_fingerprint}/s0_gate_receipt_3A.json
    type: dataset
    category: gate
    semver: '1.0.0'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.s0_gate_receipt
    license: Proprietary-Internal
    role: Gate descriptor referencing upstream PASS bundles and sealed policies.
    dependencies: [mlr.1A.validation.bundle, mlr.1B.validation.bundle, mlr.2A.validation.bundle]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/validation/s0_gate_receipt_3A
    cross_layer: true
    notes:

  - name: sealed_inputs_3A
    path: data/layer1/3A/sealed_inputs/fingerprint={manifest_fingerprint}/sealed_inputs_3A.parquet
    type: dataset
    category: inventory
    semver: '1.0.0'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.sealed_inputs
    license: Proprietary-Internal
    role: Inventory of artefacts allowed for this manifest.
    dependencies: []
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/validation/sealed_inputs_3A
    cross_layer: true
    notes:

      # ---------------------------
      # S1–S4 PLAN DATASETS
      # ---------------------------
  - name: s1_escalation_queue
    path: data/layer1/3A/s1_escalation_queue/seed={seed}/fingerprint={manifest_fingerprint}/
    type: dataset
    category: plan
    semver: '1.0.0'
    version: '{seed}.{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.s1.escalation_queue
    license: Proprietary-Internal
    role: Escalation decisions and totals per merchant×country.
    dependencies: [mlr.3A.s0_gate_receipt, mlr.1A.outlet_catalogue]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/plan/s1_escalation_queue
    cross_layer: true
    notes:

  - name: s2_country_zone_priors
    path: data/layer1/3A/s2_country_zone_priors/parameter_hash={parameter_hash}/
    type: dataset
    category: plan
    semver: '1.0.0'
    version: '{parameter_hash}'
    digest: '{sha256}'
    manifest_key: mlr.3A.s2.country_zone_priors
    license: Proprietary-Internal
    role: Effective Dirichlet α-vectors per country×tzid.
    dependencies: [mlr.3A.country_zone_alphas, mlr.3A.zone_floor_policy]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/plan/s2_country_zone_priors
    cross_layer: true
    notes:

  - name: s3_zone_shares
    path: data/layer1/3A/s3_zone_shares/seed={seed}/fingerprint={manifest_fingerprint}/
    type: dataset
    category: plan
    semver: '1.0.0'
    version: '{seed}.{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.s3.zone_shares
    license: Proprietary-Internal
    role: Dirichlet share draws per merchant×country×tzid.
    dependencies: [mlr.3A.s1.escalation_queue, mlr.3A.s2.country_zone_priors]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/plan/s3_zone_shares
    cross_layer: true
    notes:

  - name: s4_zone_counts
    path: data/layer1/3A/s4_zone_counts/seed={seed}/fingerprint={manifest_fingerprint}/
    type: dataset
    category: plan
    semver: '1.0.0'
    version: '{seed}.{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.s4.zone_counts
    license: Proprietary-Internal
    role: Integer counts after floors/bump per merchant×country×tzid.
    dependencies: [mlr.3A.s3.zone_shares, mlr.3A.zone_floor_policy]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/plan/s4_zone_counts
    cross_layer: true
    notes:

      # ---------------------------
      # S5 EGRESS + HASH UNIVERSE
      # ---------------------------
  - name: zone_alloc
    path: data/layer1/3A/zone_alloc/seed={seed}/fingerprint={manifest_fingerprint}/
    type: dataset
    category: egress
    semver: '1.0.0'
    version: '{seed}.{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.zone_alloc
    license: Proprietary-Internal
    role: Cross-layer zone allocation egress consumed by routing.
    dependencies: [mlr.3A.s4.zone_counts, mlr.3A.zone_alloc_universe_hash]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/egress/zone_alloc
    cross_layer: true
    notes:

  - name: zone_alloc_universe_hash
    path: data/layer1/3A/zone_universe/fingerprint={manifest_fingerprint}/zone_alloc_universe_hash.json
    type: dataset
    category: validation
    semver: '1.0.0'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.zone_alloc_universe_hash
    license: Proprietary-Internal
    role: Digest summary tying priors, policies, and allocation outputs.
    dependencies: [mlr.3A.country_zone_alphas, mlr.3A.zone_mixture_policy, mlr.3A.zone_floor_policy, mlr.2B.policy.day_effect_v1, mlr.3A.zone_alloc]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/validation/zone_alloc_universe_hash
    cross_layer: true
    notes:

      # ---------------------------
      # S6 VALIDATION SURFACES
      # ---------------------------
  - name: s6_validation_report_3A
    path: data/layer1/3A/s6_validation_report/fingerprint={manifest_fingerprint}/report.json
    type: dataset
    category: validation
    semver: '1.0.0'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.s6.validation_report
    license: Proprietary-Internal
    role: Structured validation summary for 3A.
    dependencies: [mlr.3A.zone_alloc, mlr.3A.zone_alloc_universe_hash]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/validation/s6_validation_report_3A
    cross_layer: true
    notes:

  - name: s6_issue_table_3A
    path: data/layer1/3A/s6_issues/fingerprint={manifest_fingerprint}/issues.parquet
    type: dataset
    category: validation
    semver: '1.0.0'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.s6.issues
    license: Proprietary-Internal
    role: Per-issue diagnostics for allocation validation.
    dependencies: [mlr.3A.s6.validation_report]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/validation/s6_issue_table_3A
    cross_layer: false
    notes:

  - name: s6_receipt_3A
    path: data/layer1/3A/s6_receipt/fingerprint={manifest_fingerprint}/s6_receipt.json
    type: dataset
    category: validation
    semver: '1.0.0'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.s6.receipt
    license: Proprietary-Internal
    role: Compact PASS/FAIL verdict consumed by S7.
    dependencies: [mlr.3A.s6.validation_report, mlr.3A.s6.issues]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.3A.yaml#/validation/s6_receipt_3A
    cross_layer: true
    notes:

      # ---------------------------
      # S7 VALIDATION BUNDLE
      # ---------------------------
  - name: validation_bundle_3A
    path: data/layer1/3A/validation/fingerprint={manifest_fingerprint}/
    type: dataset
    category: validation
    semver: '1.0.0'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.validation.bundle
    license: Proprietary-Internal
    role: Fingerprint-scoped validation bundle listing all 3A artefacts.
    dependencies: [mlr.3A.s0_gate_receipt, mlr.3A.sealed_inputs, mlr.3A.zone_alloc, mlr.3A.zone_alloc_universe_hash, mlr.3A.s6.validation_report]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.layer1.yaml#/validation/validation_bundle_index_3A
    cross_layer: true
    notes:

  - name: passed_flag_3A
    path: data/layer1/3A/validation/fingerprint={manifest_fingerprint}/_passed.flag_3A
    type: dataset
    category: validation
    semver: '1.0.0'
    version: '{manifest_fingerprint}'
    digest: '{sha256}'
    manifest_key: mlr.3A.validation.passed
    license: Proprietary-Internal
    role: HashGate PASS flag (SHA-256 over bundle members, ASCII-lex order).
    dependencies: [mlr.3A.validation.bundle]
    source: internal
    owner: {owner_team: "mlr-3a-core"}
    last_updated: '{iso8601_timestamp}'
    environment: [runtime]
    schema: schemas.layer1.yaml#/validation/passed_flag_3A
    cross_layer: true
    notes:

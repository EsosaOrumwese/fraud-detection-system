# Dataset dictionary for Layer-3 / Segment 6A
# Includes S0 gate, S1â€“S4 business datasets, S5 posture, and 6A validation.

version: '1.0.0'

lifecycle:
  phase: planning
  last_reviewed:
  approver:

ci_policy:
  allow_placeholders: false
  placeholder_markers: [TBD]
  block_on_phase: [beta, stable]

layer:
  id: layer3
  name: Layer-3 (Segment 6A)

reference_data:
  # Upstream HashGate artefacts sealed by 6A.S0
  - id: validation_bundle_1A
    owner_layer: 1
    owner_segment: 1A
    status: required
    description: Validator outputs for 1A (metrics, plots, diffs).
    version: '{manifest_fingerprint}'
    path: data/layer1/1A/validation/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.1A.yaml#/validation/validation_bundle
    columns_strict: false
    lineage:
      produced_by: [ '1A.validation' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_1A
    owner_layer: 1
    owner_segment: 1A
    status: required
    description: HashGate PASS flag for the 1A validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer1/1A/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer1.yaml#/validation/passed_flag
    columns_strict: false
    lineage:
      produced_by: [ '1A.validation' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_bundle_1B
    owner_layer: 1
    owner_segment: 1B
    status: required
    description: Validation bundle for 1B publish (one per manifest_fingerprint).
    version: '{manifest_fingerprint}'
    path: data/layer1/1B/validation/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.1B.yaml#/validation/validation_bundle_1B
    columns_strict: false
    lineage:
      produced_by: [ '1B.S9' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_1B
    owner_layer: 1
    owner_segment: 1B
    status: required
    description: HashGate PASS flag for the 1B validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer1/1B/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.1B.yaml#/validation/passed_flag
    columns_strict: false
    lineage:
      produced_by: [ '1B.S9' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_bundle_2A
    owner_layer: 1
    owner_segment: 2A
    status: required
    description: Validation bundle for 2A publish (one per fingerprint).
    version: '{manifest_fingerprint}'
    path: data/layer1/2A/validation/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.2A.yaml#/validation/validation_bundle_2A
    columns_strict: false
    lineage:
      produced_by: [ '2A.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_2A
    owner_layer: 1
    owner_segment: 2A
    status: required
    description: HashGate PASS flag for the 2A validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer1/2A/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.2A.yaml#/validation/passed_flag
    columns_strict: false
    lineage:
      produced_by: [ '2A.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_bundle_2B
    owner_layer: 1
    owner_segment: 2B
    status: required
    description: Fingerprint-scoped PASS bundle index for Segment 2B.
    version: '{manifest_fingerprint}'
    path: data/layer1/2B/validation/manifest_fingerprint={manifest_fingerprint}/index.json
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer1.yaml#/validation/validation_bundle/index_schema
    columns_strict: false
    lineage:
      produced_by: [ '2B.S8' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_2B
    owner_layer: 1
    owner_segment: 2B
    status: required
    description: HashGate PASS flag for the 2B validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer1/2B/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.1B.yaml#/validation/passed_flag
    columns_strict: false
    lineage:
      produced_by: [ '2B.S8' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_bundle_3A
    owner_layer: 1
    owner_segment: 3A
    status: required
    description: Fingerprint-scoped validation bundle for Segment 3A.
    version: '{manifest_fingerprint}'
    path: data/layer1/3A/validation/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer1.yaml#/validation/validation_bundle_index_3A
    columns_strict: false
    lineage:
      produced_by: [ '3A.S7' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_3A
    owner_layer: 1
    owner_segment: 3A
    status: required
    description: HashGate PASS flag for the 3A validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer1/3A/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer1.yaml#/validation/passed_flag_3A
    columns_strict: false
    lineage:
      produced_by: [ '3A.S7' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_bundle_3B
    owner_layer: 1
    owner_segment: 3B
    status: required
    description: Fingerprint-scoped validation bundle for Segment 3B.
    version: '{manifest_fingerprint}'
    path: data/layer1/3B/validation/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer1.yaml#/validation/validation_bundle_index_3B
    columns_strict: false
    lineage:
      produced_by: [ '3B.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_3B
    owner_layer: 1
    owner_segment: 3B
    status: required
    description: HashGate PASS flag for the 3B validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer1/3B/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer1.yaml#/validation/passed_flag_3B
    columns_strict: false
    lineage:
      produced_by: [ '3B.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_bundle_5A
    owner_layer: 2
    owner_segment: 5A
    status: required
    description: Directory artefact containing the 5A validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer2/5A/validation/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer2.yaml#/validation/validation_bundle_index_5A
    columns_strict: false
    lineage:
      produced_by: [ '5A.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_5A
    owner_layer: 2
    owner_segment: 5A
    status: required
    description: HashGate PASS flag for the 5A validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer2/5A/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer2.yaml#/validation/passed_flag_5A
    columns_strict: false
    lineage:
      produced_by: [ '5A.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_bundle_5B
    owner_layer: 2
    owner_segment: 5B
    status: required
    description: Directory artefact containing the 5B validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer2/5B/validation/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer2.yaml#/validation/validation_bundle_index_5B
    columns_strict: false
    lineage:
      produced_by: [ '5B.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_5B
    owner_layer: 2
    owner_segment: 5B
    status: required
    description: HashGate PASS flag for the 5B validation bundle.
    version: '{manifest_fingerprint}'
    path: data/layer2/5B/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer2.yaml#/validation/passed_flag_5B
    columns_strict: false
    lineage:
      produced_by: [ '5B.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  # Upstream egress/context surfaces sealed by 6A.S0
  - id: outlet_catalogue
    owner_layer: 1
    owner_segment: 1A
    status: required
    description: Immutable outlet stubs per merchant and legal country.
    version: '{manifest_fingerprint}'
    path: data/layer1/1A/outlet_catalogue/seed={seed}/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [seed, manifest_fingerprint]
    ordering: [merchant_id, legal_country_iso, site_order]
    schema_ref: schemas.1A.yaml#/egress/outlet_catalogue
    columns_strict: false
    lineage:
      produced_by: [ '1A' ]
      consumed_by: [ '6A.S0' ]
    pii_class: synthetic_customer
    retention_class: engine_control_plane

  - id: site_locations
    owner_layer: 1
    owner_segment: 1B
    status: required
    description: Site locations with absolute lat/lon (post jitter + geometry stitch).
    version: '{seed}.{manifest_fingerprint}'
    path: data/layer1/1B/site_locations/seed={seed}/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [seed, manifest_fingerprint]
    ordering: [merchant_id, legal_country_iso, site_order]
    schema_ref: schemas.1B.yaml#/egress/site_locations
    columns_strict: false
    lineage:
      produced_by: [ '1B.S8' ]
      consumed_by: [ '6A.S0' ]
    pii_class: synthetic_customer
    retention_class: engine_control_plane

  - id: site_timezones
    owner_layer: 1
    owner_segment: 2A
    status: required
    description: Final per-site IANA tzid with provenance.
    version: '{seed}.{manifest_fingerprint}'
    path: data/layer1/2A/site_timezones/seed={seed}/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [seed, manifest_fingerprint]
    ordering: [merchant_id, legal_country_iso, site_order]
    schema_ref: schemas.2A.yaml#/egress/site_timezones
    columns_strict: false
    lineage:
      produced_by: [ '2A.S2' ]
      consumed_by: [ '6A.S0' ]
    pii_class: synthetic_customer
    retention_class: engine_control_plane

  - id: tz_timetable_cache
    owner_layer: 1
    owner_segment: 2A
    status: required
    description: Fingerprint-scoped cache manifest for tz transitions.
    version: '{manifest_fingerprint}'
    path: data/layer1/2A/tz_timetable_cache/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.2A.yaml#/cache/tz_timetable_cache
    columns_strict: false
    lineage:
      produced_by: [ '2A.S3' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: zone_alloc
    owner_layer: 1
    owner_segment: 3A
    status: required
    description: Cross-layer zone allocation egress for routing segment.
    version: '{seed}.{manifest_fingerprint}'
    path: data/layer1/3A/zone_alloc/seed={seed}/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [seed, manifest_fingerprint]
    ordering: [merchant_id, legal_country_iso, tzid]
    schema_ref: schemas.3A.yaml#/egress/zone_alloc
    columns_strict: false
    lineage:
      produced_by: [ '3A.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: synthetic_customer
    retention_class: engine_control_plane

  - id: zone_alloc_universe_hash
    owner_layer: 1
    owner_segment: 3A
    status: required
    description: Digest summary tying priors and policies to the published zone allocation.
    version: '{manifest_fingerprint}'
    path: data/layer1/3A/zone_universe/manifest_fingerprint={manifest_fingerprint}/zone_alloc_universe_hash.json
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.3A.yaml#/validation/zone_alloc_universe_hash
    columns_strict: false
    lineage:
      produced_by: [ '3A.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: virtual_classification_3B
    owner_layer: 1
    owner_segment: 3B
    status: required
    description: Merchant-level classification surface with closed vocabulary reason codes.
    version: '{seed}.{manifest_fingerprint}'
    path: data/layer1/3B/virtual_classification/seed={seed}/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [seed, manifest_fingerprint]
    ordering: [merchant_id]
    schema_ref: schemas.3B.yaml#/plan/virtual_classification_3B
    columns_strict: false
    lineage:
      produced_by: [ '3B.S1' ]
      consumed_by: [ '6A.S0' ]
    pii_class: synthetic_customer
    retention_class: engine_control_plane

  - id: virtual_settlement_3B
    owner_layer: 1
    owner_segment: 3B
    status: required
    description: One settlement node per virtual merchant with tzid semantics and evidence URLs.
    version: '{seed}.{manifest_fingerprint}'
    path: data/layer1/3B/virtual_settlement/seed={seed}/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [seed, manifest_fingerprint]
    ordering: [merchant_id]
    schema_ref: schemas.3B.yaml#/plan/virtual_settlement_3B
    columns_strict: false
    lineage:
      produced_by: [ '3B.S1' ]
      consumed_by: [ '6A.S0' ]
    pii_class: synthetic_customer
    retention_class: engine_control_plane

  - id: edge_universe_hash_3B
    owner_layer: 1
    owner_segment: 3B
    status: required
    description: Fingerprint-scoped hash tying virtual routing artefacts together.
    version: '{manifest_fingerprint}'
    path: data/layer1/3B/edge_universe_hash/manifest_fingerprint={manifest_fingerprint}/edge_universe_hash_3B.json
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.3B.yaml#/validation/edge_universe_hash_3B
    columns_strict: false
    lineage:
      produced_by: [ '3B.S3' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: virtual_routing_policy_3B
    owner_layer: 1
    owner_segment: 3B
    status: required
    description: Dual-TZ routing contract for virtual merchants.
    version: '{manifest_fingerprint}'
    path: data/layer1/3B/virtual_routing_policy/manifest_fingerprint={manifest_fingerprint}/virtual_routing_policy_3B.json
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.3B.yaml#/egress/virtual_routing_policy_3B
    columns_strict: false
    lineage:
      produced_by: [ '3B.S5' ]
      consumed_by: [ '6A.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: merchant_zone_profile_5A
    owner_layer: 2
    owner_segment: 5A
    status: required
    description: Merchantxzone demand profile including class and scale for the local week.
    version: '{manifest_fingerprint}'
    path: data/layer2/5A/merchant_zone_profile/manifest_fingerprint={manifest_fingerprint}/merchant_zone_profile_5A.parquet
    partitioning: [manifest_fingerprint]
    ordering: [merchant_id, legal_country_iso, tzid]
    schema_ref: schemas.5A.yaml#/model/merchant_zone_profile_5A
    columns_strict: false
    lineage:
      produced_by: [ '5A.S1' ]
      consumed_by: [ '6A.S0' ]
    pii_class: synthetic_customer
    retention_class: engine_control_plane

  - id: arrival_events_5B
    owner_layer: 2
    owner_segment: 5B
    status: required
    description: Canonical arrival skeleton stream per scenario and seed.
    version: '{seed}.{manifest_fingerprint}.{scenario_id}'
    path: data/layer2/5B/arrival_events/seed={seed}/manifest_fingerprint={manifest_fingerprint}/scenario_id={scenario_id}/part-*.parquet
    partitioning: [seed, manifest_fingerprint, scenario_id]
    ordering: [scenario_id, merchant_id, ts_utc, arrival_seq]
    schema_ref: schemas.5B.yaml#/egress/s4_arrival_events_5B
    columns_strict: false
    lineage:
      produced_by: [ '5B.S4' ]
      consumed_by: [ '6A.S0' ]
    pii_class: synthetic_customer
    retention_class: engine_control_plane

datasets:
  - id: s0_gate_receipt_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Layer-3 / Segment 6A gate receipt. One row per manifest_fingerprint,
      summarising upstream gates and the sealed input universe for 6A.
    version: '{manifest_fingerprint}'
    path: data/layer3/6A/gate_receipt/manifest_fingerprint={manifest_fingerprint}/s0_gate_receipt_6A.json
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer3.yaml#/gate/6A/s0_gate_receipt_6A
    columns_strict: true
    lineage:
      produced_by: [ '6A.S0' ]
      consumed_by: [ '6A.S1', '6A.S2', '6A.S3', '6A.S4', '6A.S5', '6B.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: sealed_inputs_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Manifest of all artefacts 6A is authorised to depend on for a given
      manifest_fingerprint, with roles, digests, and read scopes.
    version: '{manifest_fingerprint}'
    path: data/layer3/6A/sealed_inputs/manifest_fingerprint={manifest_fingerprint}/sealed_inputs_6A.parquet
    partitioning: [manifest_fingerprint]
    ordering: [owner_layer, owner_segment, manifest_key]
    schema_ref: schemas.layer3.yaml#/gate/6A/sealed_inputs_6A
    columns_strict: true
    lineage:
      produced_by: [ '6A.S0' ]
      consumed_by: [ '6A.S1', '6A.S2', '6A.S3', '6A.S4', '6A.S5', '6B.S0' ]
    pii_class: none
    retention_class: engine_control_plane

  # --- S0 sealed inputs (priors & taxonomies) ---

  - id: prior_population_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Population priors pack for 6A (world/region totals, mixtures, demographics).
    version: 'v1'
    path: config/layer3/6A/priors/population_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/population_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S1' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_segmentation_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Segmentation priors for 6A (party_type/segment mixes and region splits).
    version: 'v1'
    path: config/layer3/6A/priors/segmentation_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/segmentation_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S1' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: taxonomy_party_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Party/segment/region taxonomies for 6A.
    version: 'v1'
    path: config/layer3/6A/taxonomy/party_taxonomy_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/taxonomy/party_taxonomy_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S1' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_account_per_party_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Priors for account counts per party and per segment.
    version: 'v1'
    path: config/layer3/6A/priors/account_per_party_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/account_per_party_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S2' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_product_mix_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Priors for account/product mix by party segment and region.
    version: 'v1'
    path: config/layer3/6A/priors/product_mix_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/product_mix_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S2' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: taxonomy_account_types_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Account/product taxonomies for 6A.
    version: 'v1'
    path: config/layer3/6A/taxonomy/account_taxonomy_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/taxonomy/account_taxonomy_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S2' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_instrument_per_account_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Priors for instrument counts per account.
    version: 'v1'
    path: config/layer3/6A/priors/instrument_per_account_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/instrument_per_account_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S3' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_instrument_mix_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Priors for instrument type and scheme mixes.
    version: 'v1'
    path: config/layer3/6A/priors/instrument_mix_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/instrument_mix_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S3' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: taxonomy_instrument_types_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Instrument, scheme, and network taxonomies for 6A.
    version: 'v1'
    path: config/layer3/6A/taxonomy/instrument_taxonomy_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/taxonomy/instrument_taxonomy_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S3' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_device_counts_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Priors for device counts and sharing behavior.
    version: 'v1'
    path: config/layer3/6A/priors/device_count_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/device_count_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S4' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: taxonomy_devices_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Device taxonomies (device_type, OS, UA families, risk codes).
    version: 'v1'
    path: config/layer3/6A/taxonomy/device_taxonomy_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/taxonomy/device_taxonomy_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S4' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_ip_counts_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Priors for IP/endpoint counts and sharing behavior.
    version: 'v1'
    path: config/layer3/6A/priors/ip_count_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/ip_count_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S4' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: taxonomy_ips_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: IP/endpoint taxonomies (type and ASN class).
    version: 'v1'
    path: config/layer3/6A/taxonomy/ip_taxonomy_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/taxonomy/ip_taxonomy_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S4' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: taxonomy_fraud_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Fraud-role enum taxonomy for parties/accounts/merchants/devices/IPs.
    version: 'v1'
    path: config/layer3/6A/taxonomy/fraud_role_taxonomy_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/taxonomy/fraud_role_taxonomy_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_party_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Fraud-role priors for parties.
    version: 'v1'
    path: config/layer3/6A/priors/party_role_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/party_role_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_account_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Fraud-role priors for accounts.
    version: 'v1'
    path: config/layer3/6A/priors/account_role_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/account_role_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_merchant_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Fraud-role priors for merchants.
    version: 'v1'
    path: config/layer3/6A/priors/merchant_role_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/merchant_role_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_device_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Fraud-role priors for devices.
    version: 'v1'
    path: config/layer3/6A/priors/device_role_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/device_role_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: prior_ip_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Fraud-role priors for IPs/endpoints.
    version: 'v1'
    path: config/layer3/6A/priors/ip_role_priors_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/prior/ip_role_priors_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_policy_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Validation policy/checklist for 6A.S5 (PASS/WARN/FAIL thresholds and required checks).
    version: 'v1'
    path: config/layer3/6A/policy/validation_policy_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/policy/validation_policy_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: graph_linkage_rules_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Graph/linkage rules for 6A.S4 (device/IP sharing, degree caps, deterministic tie-breaks).
    version: 'v1'
    path: config/layer3/6A/policy/graph_linkage_rules_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/policy/graph_linkage_rules_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S4' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: device_linkage_rules_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Device-specific linkage rules for 6A.S4 (sharing patterns and degree caps).
    version: 'v1'
    path: config/layer3/6A/policy/device_linkage_rules_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/policy/device_linkage_rules_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S4' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: product_linkage_rules_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: Optional product linkage rules for 6A.S2 (account/product wiring constraints).
    version: 'v1'
    path: config/layer3/6A/policy/product_linkage_rules_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/policy/product_linkage_rules_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S2' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: product_eligibility_config_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: Optional product eligibility config for 6A.S2 (account/product admissibility rules).
    version: 'v1'
    path: config/layer3/6A/policy/product_eligibility_config_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/policy/product_eligibility_config_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S2' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: instrument_linkage_rules_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: Optional instrument linkage rules for 6A.S3 (instrument ownership constraints).
    version: 'v1'
    path: config/layer3/6A/policy/instrument_linkage_rules_6A.v1.yaml
    partitioning: []
    ordering: []
    schema_ref: schemas.6A.yaml#/policy/instrument_linkage_rules_6A
    columns_strict: false
    lineage:
      produced_by: []
      consumed_by: [ '6A.S0', '6A.S3' ]
    pii_class: none
    retention_class: engine_control_plane

  # --- RNG logs & event tables ---

  - id: rng_audit_log
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Run-scoped RNG audit envelope for 6A runs.
    version: '{run_id}'
    path: logs/layer3/6A/rng/audit/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/rng_audit_log.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/core/rng_audit_log
    columns_strict: false
    lineage:
      produced_by: [ '6A.S1', '6A.S2', '6A.S3', '6A.S4', '6A.S5' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_trace_log
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: Aggregated RNG trace log for 6A runs (per event family draws/blocks).
    version: '{run_id}'
    path: logs/layer3/6A/rng/trace/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/rng_trace_log.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/core/rng_trace_log
    columns_strict: false
    lineage:
      produced_by: [ '6A.S1', '6A.S2', '6A.S3', '6A.S4', '6A.S5' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_party_count_realisation
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S1 party count realisation.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/party_count_realisation/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/party_count_realisation
    columns_strict: false
    lineage:
      produced_by: [ '6A.S1' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_party_attribute_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S1 party attribute sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/party_attribute_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/party_attribute_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S1' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_account_count_realisation
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S2 account count realisation.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/account_count_realisation/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/account_count_realisation
    columns_strict: false
    lineage:
      produced_by: [ '6A.S2' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_account_allocation_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S2 account allocation sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/account_allocation_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/account_allocation_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S2' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_account_attribute_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S2 account attribute sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/account_attribute_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/account_attribute_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S2' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_instrument_count_realisation
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S3 instrument count realisation.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/instrument_count_realisation/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/instrument_count_realisation
    columns_strict: false
    lineage:
      produced_by: [ '6A.S3' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_instrument_allocation_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S3 instrument allocation sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/instrument_allocation_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/instrument_allocation_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S3' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_instrument_attribute_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S3 instrument attribute sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/instrument_attribute_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/instrument_attribute_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S3' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_device_count_realisation
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S4 device count realisation.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/device_count_realisation/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/device_count_realisation
    columns_strict: false
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_device_allocation_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S4 device allocation sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/device_allocation_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/device_allocation_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_device_attribute_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S4 device attribute sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/device_attribute_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/device_attribute_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_ip_count_realisation
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S4 IP count realisation.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/ip_count_realisation/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/ip_count_realisation
    columns_strict: false
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_ip_allocation_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S4 IP allocation sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/ip_allocation_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/ip_allocation_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_ip_attribute_sampling
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S4 IP attribute sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/ip_attribute_sampling/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/ip_attribute_sampling
    columns_strict: false
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_fraud_role_sampling_party
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S5 party fraud-role sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/fraud_role_sampling_party/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/fraud_role_sampling_party
    columns_strict: false
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_fraud_role_sampling_account
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S5 account fraud-role sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/fraud_role_sampling_account/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/fraud_role_sampling_account
    columns_strict: false
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_fraud_role_sampling_merchant
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S5 merchant fraud-role sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/fraud_role_sampling_merchant/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/fraud_role_sampling_merchant
    columns_strict: false
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_fraud_role_sampling_device
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S5 device fraud-role sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/fraud_role_sampling_device/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/fraud_role_sampling_device
    columns_strict: false
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  - id: rng_event_fraud_role_sampling_ip
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: RNG events for 6A.S5 IP fraud-role sampling.
    version: '{run_id}'
    path: logs/layer3/6A/rng/events/fraud_role_sampling_ip/seed={seed}/parameter_hash={parameter_hash}/run_id={run_id}/part-*.jsonl
    partitioning: [seed, parameter_hash, run_id]
    ordering: []
    schema_ref: schemas.layer3.yaml#/rng/events/fraud_role_sampling_ip
    columns_strict: false
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by: [ '6A.S5' ]
    pii_class: none
    retention_class: engine_control_plane

  # --- S1 ---

  - id: s1_party_base_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Base party/customer universe for Layer-3 / Segment 6A.
      One row per party per (manifest_fingerprint, seed), including type,
      home geography and static segment attributes.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s1_party_base_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s1_party_base_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [country_iso, segment_id, party_type, party_id]
    schema_ref: schemas.6A.yaml#/s1/party_base
    columns_strict: true
    lineage:
      produced_by: [ '6A.S1' ]
      consumed_by:
        - '6A.S2'
        - '6A.S3'
        - '6A.S4'
        - '6A.S5'
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s1_party_summary_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: >
      Aggregate view of the 6A party base, providing party counts by
      geography, segment and type for diagnostics and downstream sizing.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s1_party_summary_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s1_party_summary_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [country_iso, segment_id, party_type]
    schema_ref: schemas.6A.yaml#/s1/party_summary
    columns_strict: true
    lineage:
      produced_by: [ '6A.S1' ]
      consumed_by:
        - '6A.S1'
        - '6A.S2'
        - '6B.S0'
    pii_class: synthetic_customer
    retention_class: diagnostics

  # --- S2 ---

  - id: s2_account_base_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Account and product universe for Layer-3 / Segment 6A.
      One row per account per (manifest_fingerprint, seed), including owner
      references, account type, currency and static account attributes.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s2_account_base_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s2_account_base_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [country_iso, account_type, owner_party_id, account_id]
    schema_ref: schemas.6A.yaml#/s2/account_base
    columns_strict: true
    lineage:
      produced_by: [ '6A.S2' ]
      consumed_by:
        - '6A.S3'
        - '6A.S4'
        - '6A.S5'
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s2_party_product_holdings_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Per-party product holdings for Layer-3 / Segment 6A, derived from
      s2_account_base_6A and s1_party_base_6A. One row per party and
      product grouping (e.g. account_type), with account counts.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s2_party_product_holdings_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s2_party_product_holdings_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [party_id, account_type]
    schema_ref: schemas.6A.yaml#/s2/party_product_holdings
    columns_strict: true
    lineage:
      produced_by: [ '6A.S2' ]
      consumed_by:
        - '6A.S3'
        - '6A.S4'
        - '6A.S5'
        - '6B.S0'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s2_merchant_account_base_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: >
      Merchant-centric view of accounts where a merchant is an owner
      (e.g. settlement or acquiring accounts). Pure subset of s2_account_base_6A.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s2_merchant_account_base_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s2_merchant_account_base_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [owner_merchant_id, account_type, account_id]
    schema_ref: schemas.6A.yaml#/s2/merchant_account_base
    columns_strict: true
    lineage:
      produced_by: [ '6A.S2' ]
      consumed_by:
        - '6A.S2'
        - '6B.S0'
    pii_class: synthetic_customer
    retention_class: diagnostics

  - id: s2_account_summary_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: >
      Aggregate view of the 6A account base, providing account counts
      by geography, segment and account type for diagnostics and sizing.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s2_account_summary_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s2_account_summary_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [country_iso, segment_id, account_type]
    schema_ref: schemas.6A.yaml#/s2/account_summary
    columns_strict: true
    lineage:
      produced_by: [ '6A.S2' ]
      consumed_by:
        - '6A.S2'
        - '6B.S0'
    pii_class: synthetic_customer
    retention_class: diagnostics

  # --- S3 ---

  - id: s3_instrument_base_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Instrument and payment-credential universe for Layer-3 / Segment 6A.
      One row per instrument per (manifest_fingerprint, seed), including
      owner account, owner party/merchant (if modelled), instrument type,
      scheme/network, masked identifier, expiry, and static flags.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s3_instrument_base_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s3_instrument_base_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [account_id, instrument_type, scheme, instrument_id]
    schema_ref: schemas.6A.yaml#/s3/instrument_base
    columns_strict: true
    lineage:
      produced_by: [ '6A.S3' ]
      consumed_by:
        - '6A.S4'
        - '6A.S5'
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s3_account_instrument_links_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Per-account instrument linkage surface for Layer-3 / Segment 6A.
      Derived from s3_instrument_base_6A and s2_account_base_6A; provides
      either per-instrument or aggregated per-account, per-instrument-type
      views of instrument ownership.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s3_account_instrument_links_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s3_account_instrument_links_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [account_id, instrument_type, scheme, instrument_id]
    schema_ref: schemas.6A.yaml#/s3/account_instrument_links
    columns_strict: true
    lineage:
      produced_by: [ '6A.S3' ]
      consumed_by:
        - '6A.S4'
        - '6A.S5'
        - '6B.S0'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s3_party_instrument_holdings_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: >
      Per-party instrument holdings for Layer-3 / Segment 6A, derived
      from s3_instrument_base_6A and s1_party_base_6A; one row per
      (party_id, instrument grouping) with instrument_count.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s3_party_instrument_holdings_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s3_party_instrument_holdings_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [party_id, instrument_type, scheme]
    schema_ref: schemas.6A.yaml#/s3/party_instrument_holdings
    columns_strict: true
    lineage:
      produced_by: [ '6A.S3' ]
      consumed_by:
        - '6A.S4'
        - '6A.S5'
        - '6B.S0'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s3_instrument_summary_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: >
      Aggregate instrument diagnostics for Layer-3 / Segment 6A, providing
      instrument counts by geography, segment, account_type and instrument_type.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s3_instrument_summary_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s3_instrument_summary_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [region_id, segment_id, account_type, instrument_type, scheme]
    schema_ref: schemas.6A.yaml#/s3/instrument_summary
    columns_strict: true
    lineage:
      produced_by: [ '6A.S3' ]
      consumed_by:
        - '6A.S3'
        - '6A.S4'
        - '6B.S0'
    pii_class: synthetic_customer
    retention_class: diagnostics

  # --- S4 ---

  - id: s4_device_base_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Device universe for Layer-3 / Segment 6A. One row per device per
      (manifest_fingerprint, seed), with device classification, primary
      owner context and static device risk/capability flags.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s4_device_base_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s4_device_base_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [device_type, primary_party_id, primary_merchant_id, device_id]
    schema_ref: schemas.6A.yaml#/s4/device_base
    columns_strict: true
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by:
        - '6A.S5'
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s4_ip_base_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      IP / network endpoint universe for Layer-3 / Segment 6A. One row
      per IP/endpoint per (manifest_fingerprint, seed), including masked
      representation, ip_type, asn_class, geo hints and static risk tags.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s4_ip_base_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s4_ip_base_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [ip_type, asn_class, country_iso, ip_id]
    schema_ref: schemas.6A.yaml#/s4/ip_base
    columns_strict: true
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by:
        - '6A.S5'
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s4_device_links_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Device-to-entity edges for Layer-3 / Segment 6A. Links each
      device_id to one or more parties/accounts/instruments/merchants
      with a link_role describing the semantics.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s4_device_links_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s4_device_links_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [device_id, party_id, account_id, instrument_id, merchant_id, link_role]
    schema_ref: schemas.6A.yaml#/s4/device_links
    columns_strict: true
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by:
        - '6A.S5'
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s4_ip_links_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      IP-to-device/entity edges for Layer-3 / Segment 6A. Links each ip_id
      to one or more devices/parties/merchants with a link_role
      describing the semantics.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s4_ip_links_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s4_ip_links_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [ip_id, device_id, party_id, merchant_id, link_role]
    schema_ref: schemas.6A.yaml#/s4/ip_links
    columns_strict: true
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by:
        - '6A.S5'
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s4_entity_neighbourhoods_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: >
      Per-entity graph neighbourhood metrics for Layer-3 / Segment 6A
      (devices per party, IPs per device, shared-device/shared-IP
      degrees, etc.), derived from S4 base and link datasets.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s4_entity_neighbourhoods_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s4_entity_neighbourhoods_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [entity_type, entity_id]
    schema_ref: schemas.6A.yaml#/s4/entity_neighbourhoods
    columns_strict: true
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by:
        - '6A.S5'
        - '6B.S0'
    pii_class: synthetic_customer
    retention_class: diagnostics

  - id: s4_network_summary_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: >
      Aggregate graph diagnostics for Layer-3 / Segment 6A: degree
      distributions and sharing summaries per region/segment/account_type
      and globally.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s4_network_summary_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s4_network_summary_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [region_id, segment_id, account_type, metric_id]
    schema_ref: schemas.6A.yaml#/s4/network_summary
    columns_strict: true
    lineage:
      produced_by: [ '6A.S4' ]
      consumed_by:
        - '6A.S4'
        - '6A.S5'
        - '6B.S0'
    pii_class: none
    retention_class: diagnostics

  # --- S5 fraud roles (seed-scoped) ---

  - id: s5_party_fraud_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Static fraud posture for parties in Layer-3 / Segment 6A.
      One row per party per (manifest_fingerprint, seed).
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s5_party_fraud_roles_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s5_party_fraud_roles_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [party_id]
    schema_ref: schemas.6A.yaml#/s5/party_fraud_roles
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
        - '6B.S2'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s5_account_fraud_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Static fraud posture for accounts in Layer-3 / Segment 6A.
      One row per account per (manifest_fingerprint, seed).
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s5_account_fraud_roles_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s5_account_fraud_roles_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [account_id]
    schema_ref: schemas.6A.yaml#/s5/account_fraud_roles
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
        - '6B.S2'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s5_merchant_fraud_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Static fraud posture for merchants in Layer-3 / Segment 6A.
      One row per merchant, keyed by merchant_id.
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s5_merchant_fraud_roles_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s5_merchant_fraud_roles_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [merchant_id]
    schema_ref: schemas.6A.yaml#/s5/merchant_fraud_roles
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
        - '6B.S2'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s5_device_fraud_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Static fraud posture for devices in Layer-3 / Segment 6A.
      One row per device per (manifest_fingerprint, seed).
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s5_device_fraud_roles_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s5_device_fraud_roles_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [device_id]
    schema_ref: schemas.6A.yaml#/s5/device_fraud_roles
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  - id: s5_ip_fraud_roles_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Static fraud posture for IPs/endpoints in Layer-3 / Segment 6A.
      One row per ip_id per (manifest_fingerprint, seed).
    version: '{seed}.{manifest_fingerprint}.{parameter_hash}'
    path: data/layer3/6A/s5_ip_fraud_roles_6A/seed={seed}/parameter_hash={parameter_hash}/manifest_fingerprint={manifest_fingerprint}/s5_ip_fraud_roles_6A.parquet
    partitioning: [seed, manifest_fingerprint, parameter_hash]
    ordering: [ip_id]
    schema_ref: schemas.6A.yaml#/s5/ip_fraud_roles
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: core_entity

  # --- S5 validation & HashGate (fingerprint-scoped) ---

  - id: s5_validation_report_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Segment-level validation report for Layer-3 / Segment 6A,
      summarising the results of S5 checks across S1â€“S4 and S5 fraud roles.
    version: '{manifest_fingerprint}'
    path: data/layer3/6A/validation/manifest_fingerprint={manifest_fingerprint}/s5_validation_report_6A.json
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer3.yaml#/validation/6A/validation_report_6A
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
    pii_class: none
    retention_class: engine_control_plane

  - id: s5_issue_table_6A
    owner_layer: 3
    owner_segment: 6A
    status: optional
    description: >
      Row-level issue table for 6A validation, containing one row per
      failing/borderline check instance.
    version: '{manifest_fingerprint}'
    path: data/layer3/6A/validation/manifest_fingerprint={manifest_fingerprint}/s5_issue_table_6A.parquet
    partitioning: [manifest_fingerprint]
    ordering: [check_id, scope_type, issue_id]
    schema_ref: schemas.layer3.yaml#/validation/6A/validation_issue_table_6A
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
    pii_class: synthetic_customer
    retention_class: engine_control_plane

  - id: validation_bundle_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Validation bundle directory for Layer-3 / Segment 6A, containing the
      evidence index and HashGate outputs for this manifest_fingerprint.
    version: '{manifest_fingerprint}'
    path: data/layer3/6A/validation/manifest_fingerprint={manifest_fingerprint}/
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: null
    columns_strict: false
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_bundle_index_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      Index for the Layer-3 / Segment 6A validation bundle, listing
      all evidence files and their SHA-256 digests.
    version: '{manifest_fingerprint}'
    path: data/layer3/6A/validation/manifest_fingerprint={manifest_fingerprint}/validation_bundle_index_6A.json
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer3.yaml#/validation/6A/validation_bundle_index_6A
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
    pii_class: none
    retention_class: engine_control_plane

  - id: validation_passed_flag_6A
    owner_layer: 3
    owner_segment: 6A
    status: required
    description: >
      HashGate flag for Layer-3 / Segment 6A. Contains the SHA-256
      digest over the validation bundle for this manifest_fingerprint.
    version: '{manifest_fingerprint}'
    path: data/layer3/6A/validation/manifest_fingerprint={manifest_fingerprint}/_passed.flag
    partitioning: [manifest_fingerprint]
    ordering: []
    schema_ref: schemas.layer3.yaml#/validation/6A/passed_flag_6A
    columns_strict: true
    lineage:
      produced_by: [ '6A.S5' ]
      consumed_by:
        - '6B.S0'
        - '6B.S1'
    pii_class: none
    retention_class: engine_control_plane

$schema: "https://json-schema.org/draft/2020-12/schema"
$id: schemas.6A.yaml
title: "Layer-3 / Segment 6A â€” business dataset schemas"
description: >-
  Anchors for the Layer-3 / Segment 6A business datasets. Each anchor is a
  placeholder; implementation work will extend these schema nodes with the
  concrete field definitions derived from the state specs.
type: object
additionalProperties: false

prior:
  description: "6A prior inputs sealed at S0"
  additionalProperties: false
  properties:
    population_priors_6A:
      $id: "#/prior/population_priors_6A"
      type: object
      description: "Population priors pack for 6A."
    segmentation_priors_6A:
      $id: "#/prior/segmentation_priors_6A"
      type: object
      description: "Segmentation priors pack for 6A."
    account_per_party_priors_6A:
      $id: "#/prior/account_per_party_priors_6A"
      type: object
      description: "Account-per-party priors for 6A."
    product_mix_priors_6A:
      $id: "#/prior/product_mix_priors_6A"
      type: object
      description: "Product mix priors for 6A."
    instrument_per_account_priors_6A:
      $id: "#/prior/instrument_per_account_priors_6A"
      type: object
      description: "Instrument-per-account priors for 6A."
    instrument_mix_priors_6A:
      $id: "#/prior/instrument_mix_priors_6A"
      type: object
      description: "Instrument mix priors for 6A."
    device_count_priors_6A:
      $id: "#/prior/device_count_priors_6A"
      type: object
      description: "Device count priors for 6A."
    ip_count_priors_6A:
      $id: "#/prior/ip_count_priors_6A"
      type: object
      description: "IP count priors for 6A."
    party_role_priors_6A:
      $id: "#/prior/party_role_priors_6A"
      type: object
      description: "Party fraud-role priors for 6A."
    account_role_priors_6A:
      $id: "#/prior/account_role_priors_6A"
      type: object
      description: "Account fraud-role priors for 6A."
    merchant_role_priors_6A:
      $id: "#/prior/merchant_role_priors_6A"
      type: object
      description: "Merchant fraud-role priors for 6A."
    device_role_priors_6A:
      $id: "#/prior/device_role_priors_6A"
      type: object
      description: "Device fraud-role priors for 6A."
    ip_role_priors_6A:
      $id: "#/prior/ip_role_priors_6A"
      type: object
      description: "IP fraud-role priors for 6A."

taxonomy:
  description: "6A taxonomy inputs sealed at S0"
  additionalProperties: false
  properties:
    party_taxonomy_6A:
      $id: "#/taxonomy/party_taxonomy_6A"
      type: object
      description: "Party/segment/region taxonomies for 6A."
    account_taxonomy_6A:
      $id: "#/taxonomy/account_taxonomy_6A"
      type: object
      description: "Account/product taxonomies for 6A."
    instrument_taxonomy_6A:
      $id: "#/taxonomy/instrument_taxonomy_6A"
      type: object
      description: "Instrument taxonomies for 6A."
    device_taxonomy_6A:
      $id: "#/taxonomy/device_taxonomy_6A"
      type: object
      description: "Device taxonomies for 6A."
    ip_taxonomy_6A:
      $id: "#/taxonomy/ip_taxonomy_6A"
      type: object
      description: "IP taxonomies for 6A."
    fraud_role_taxonomy_6A:
      $id: "#/taxonomy/fraud_role_taxonomy_6A"
      type: object
      description: "Fraud-role enum taxonomy for 6A (party/account/merchant/device/ip)."

policy:
  description: "6A policy inputs sealed at S0"
  additionalProperties: false
  properties:
    validation_policy_6A:
      $id: "#/policy/validation_policy_6A"
      type: object
      description: "6A.S5 validation policy/checklist (PASS/WARN/FAIL thresholds and required checks)."

s1:
  description: "State 6A.S1 outputs"
  additionalProperties: false
  properties:
    party_base:
      $id: "#/s1/party_base"
      type: object
      description: "Party/customer base row for 6A"
    party_summary:
      $id: "#/s1/party_summary"
      type: object
      description: "Party-level diagnostic summary row (optional)"

s2:
  description: "State 6A.S2 outputs"
  additionalProperties: false
  properties:
    account_base:
      $id: "#/s2/account_base"
      type: object
      description: "Account/product base row"
    party_product_holdings:
      $id: "#/s2/party_product_holdings"
      type: object
      description: "Per-party holdings row"
    merchant_account_base:
      $id: "#/s2/merchant_account_base"
      type: object
      description: "Merchant-account subset (optional)"
    account_summary:
      $id: "#/s2/account_summary"
      type: object
      description: "Account summary / diagnostics (optional)"

s3:
  description: "State 6A.S3 outputs"
  additionalProperties: false
  properties:
    instrument_base:
      $id: "#/s3/instrument_base"
      type: object
      description: "Instrument/payment-credential base row"
    account_instrument_links:
      $id: "#/s3/account_instrument_links"
      type: object
      description: "Per-account instrument linkage row"
    party_instrument_holdings:
      $id: "#/s3/party_instrument_holdings"
      type: object
      description: "Per-party instrument holdings row (optional)"
    instrument_summary:
      $id: "#/s3/instrument_summary"
      type: object
      description: "Instrument diagnostics row (optional)"

s4:
  description: "State 6A.S4 outputs"
  additionalProperties: false
  properties:
    device_base:
      $id: "#/s4/device_base"
      type: object
      description: "Device base row"
    ip_base:
      $id: "#/s4/ip_base"
      type: object
      description: "IP/endpoint base row"
    device_links:
      $id: "#/s4/device_links"
      type: object
      description: "Device-to-entity edge row"
    ip_links:
      $id: "#/s4/ip_links"
      type: object
      description: "IP-to-entity edge row"
    entity_neighbourhoods:
      $id: "#/s4/entity_neighbourhoods"
      type: object
      description: "Per-entity graph neighbourhood row (optional)"
    network_summary:
      $id: "#/s4/network_summary"
      type: object
      description: "Graph diagnostics row (optional)"

s5:
  description: "State 6A.S5 outputs"
  additionalProperties: false
  properties:
    party_fraud_roles:
      $id: "#/s5/party_fraud_roles"
      type: object
      description: "Fraud posture row for a party"
    account_fraud_roles:
      $id: "#/s5/account_fraud_roles"
      type: object
      description: "Fraud posture row for an account"
    merchant_fraud_roles:
      $id: "#/s5/merchant_fraud_roles"
      type: object
      description: "Fraud posture row for a merchant"
    device_fraud_roles:
      $id: "#/s5/device_fraud_roles"
      type: object
      description: "Fraud posture row for a device"
    ip_fraud_roles:
      $id: "#/s5/ip_fraud_roles"
      type: object
      description: "Fraud posture row for an IP"

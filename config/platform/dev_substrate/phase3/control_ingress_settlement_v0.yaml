version: 1
settlement_id: dev_min_phase3_control_ingress_v0
plane: control_and_ingress
status: active

scope:
  services:
    - scenario_runner
    - world_streamer_producer
    - ingestion_gate
    - event_bus
    - oracle_store
  ownership:
    scenario_runner: run_readiness_and_join_surface
    ingestion_gate: admission_decisions_and_receipts
    event_bus: offset_and_replay_anchor_truth
    oracle_store: sealed_world_artifacts

local_parity_carry_forward_refs:
  - docs/model_spec/platform/implementation_maps/local_parity/platform.impl_actual.md
  - docs/model_spec/platform/implementation_maps/local_parity/scenario_runner.impl_actual.md
  - docs/model_spec/platform/implementation_maps/local_parity/world_streamer_producer.impl_actual.md
  - docs/model_spec/platform/implementation_maps/local_parity/ingestion_gate.impl_actual.md
  - docs/model_spec/platform/implementation_maps/local_parity/event_bus.impl_actual.md
  - docs/model_spec/platform/implementation_maps/local_parity/oracle_store.impl_actual.md

policy:
  partitioning_profile_id: ig.partitioning.v0.traffic
  require_gate_pass: true
  topic_corridor:
    provider: confluent_cloud
    topics:
      - name: fp.bus.control.v1
        role: control
        partitions: 3
        replication_factor: 3
        retention_ms: 604800000
      - name: fp.bus.audit.v1
        role: audit
        partitions: 3
        replication_factor: 3
        retention_ms: 1209600000
      - name: fp.bus.traffic.fraud.v1
        role: traffic
        partitions: 6
        replication_factor: 3
        retention_ms: 604800000
      - name: fp.bus.context.arrival_events.v1
        role: context
        partitions: 6
        replication_factor: 3
        retention_ms: 604800000
      - name: fp.bus.context.arrival_entities.v1
        role: context
        partitions: 6
        replication_factor: 3
        retention_ms: 604800000
      - name: fp.bus.context.flow_anchor.fraud.v1
        role: flow_anchor
        partitions: 6
        replication_factor: 3
        retention_ms: 604800000

storage:
  object_store:
    bucket_env: DEV_MIN_OBJECT_STORE_BUCKET
    oracle_prefix: dev_min/oracle
    oracle_retention_days: 30
  evidence_store:
    bucket_env: DEV_MIN_EVIDENCE_BUCKET
    prefix: dev_min/evidence
    retention_days: 30
  quarantine_store:
    bucket_env: DEV_MIN_QUARANTINE_BUCKET
    prefix: dev_min/quarantine
    retention_days: 30
  archive_store:
    bucket_env: DEV_MIN_ARCHIVE_BUCKET
    prefix: dev_min/archive
    retention_days: 30

ig_durability_prerequisites:
  control_table_env: DEV_MIN_CONTROL_TABLE
  admission_state_table_env: DEV_MIN_IG_ADMISSION_TABLE
  publish_state_table_env: DEV_MIN_IG_PUBLISH_STATE_TABLE

auth_capability_boundary:
  ingress_auth_mode: api_key
  ingress_api_key_header: X-IG-Service-Token
  kafka_credential_envs:
    - DEV_MIN_KAFKA_API_KEY
    - DEV_MIN_KAFKA_API_SECRET
  acl_posture:
    mode: preprovisioned_single_principal
    note: Fine-grained ACL introspection is out of scope for v0 checker and is handled by external operator controls.

validation_ladder:
  smoke_events: 20
  acceptance_events: 200
  stress_events: 1000

performance_targets:
  ingest_p95_ms: 1500
  publish_p95_ms: 1500
  e2e_p95_ms: 5000
  throughput_events_per_sec_min: 50

cost_targets:
  max_usd_smoke_20: 1.0
  max_usd_acceptance_200: 3.0
  max_usd_stress_1000: 8.0
